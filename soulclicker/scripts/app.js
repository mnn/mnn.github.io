function initializeTemplates($templateCache){$templateCache.put("app/about/about.template.html",'<md-dialog class=dialog-about><md-dialog-content><md-list><md-subheader>[[aboutTitle]]</md-subheader><md-list-item><div class=about-wrapper><p class=about-keys><mail target="gm@ail co@m mku@cera@22"></mail>[[martin]]</p><p class=about-roles>[[martinRoles]]</p><p class=about-keys-small>[[martinNotes]]</p></div></md-list-item><md-list-item><div class=about-wrapper><p class=about-keys><mail target="g@ma@il c@om rk@uc@era9@0"></mail>[[radek]]</p><p class=about-roles>[[radekRoles]]</p><p class=about-keys-small>[[radekNotes]]</p></div></md-list-item><div class=about-donate-spacer></div><md-subheader>[[aboutDonate]]</md-subheader><div class="about-wrapper about-donate-text">[[aboutDonateText]]<donate></donate></div><div class=about-donate-spacer></div><md-subheader>[[aboutCredits]]</md-subheader><div class=about-donate-spacer></div><div class=about-wrapper>lodash, AngularJS, Angular Material, jQuery, UI Router, VelocityJS, Sansita font (<a href=http://scripts.sil.org/OFL target=_blank>OFL</a>)</div><div class=about-donate-spacer></div></md-list></md-dialog-content><div class="md-actions about-actions"><md-button class="md-raised md-primary" ng-click=ctrl.close()>[[closeButton]]</md-button></div></md-dialog>'),$templateCache.put("app/bottle/bottle.template.html",'<div class="bottle fullHeight" flex layout=column layout-align="center center" layout-padding><modifiers-info modifiers=modifiers></modifiers-info><div flex layout-wrap class=bottle-bg-image ng-click=ctrl.triggered($event)>&nbsp;</div><div flex=20 class="bottle-text md-whiteframe-z2"><div>[[souls]]: <span class=bottle-value>{{ctrl.formatNumber(bank)}}</span><mini-soul></mini-soul></div><div>[[soulsPerSecond]]: <span class=bottle-value>{{ctrl.formatNumber(perSecond, false)}}</span><souls-per-second></souls-per-second></div><div>[[soulsPerClick]]: <span class=bottle-value>{{ctrl.formatNumber(perClick, false)}}</span><mini-soul></mini-soul></div></div></div>'),$templateCache.put("app/common/donate.template.html",'<form action=https://www.paypal.com/cgi-bin/webscr method=post target=_blank><input type=hidden name=cmd value=_s-xclick> <input type=hidden name=encrypted value="-----BEGIN PKCS7-----MIIHRwYJKoZIhvcNAQcEoIIHODCCBzQCAQExggEwMIIBLAIBADCBlDCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20CAQAwDQYJKoZIhvcNAQEBBQAEgYARLV5n2YiS1FTpnvrOpyQyQNmcAqS9uVZOXWDLuldDUXWBfY2a54Kz14PqkuuPpib5mX5yYbX97WmgOOybQ2IlMGyP/iqU5MGKhNMnYdrSh8vl48CeIhRFhRGoIupJO+5HziHi9DnExMzWM9GVcQ3IEafFIMskMsHrK5+m0bulcjELMAkGBSsOAwIaBQAwgcQGCSqGSIb3DQEHATAUBggqhkiG9w0DBwQIGGfUZ7yuAomAgaDqCQlxbPcYAbSNi9mD7IZ1+c40v51V6TEYy1DegA3fSzo9Vs+upX7YozuqjCvYQ3dQpnf858WEaSEN4nlqTaqAXrJeHkC8lhqXKCnEH7IvrYEklUbqjI5YvGygJRfa1ImyCycenr1/t6caTAIvsE5X/SnPQhX/jOOuc1Ky5cJZkzgjgY5iFTcCJDbNKV9Q0WLIhz4Ay2dEPuF5NplgmwE1oIIDhzCCA4MwggLsoAMCAQICAQAwDQYJKoZIhvcNAQEFBQAwgY4xCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEUMBIGA1UEChMLUGF5UGFsIEluYy4xEzARBgNVBAsUCmxpdmVfY2VydHMxETAPBgNVBAMUCGxpdmVfYXBpMRwwGgYJKoZIhvcNAQkBFg1yZUBwYXlwYWwuY29tMB4XDTA0MDIxMzEwMTMxNVoXDTM1MDIxMzEwMTMxNVowgY4xCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEUMBIGA1UEChMLUGF5UGFsIEluYy4xEzARBgNVBAsUCmxpdmVfY2VydHMxETAPBgNVBAMUCGxpdmVfYXBpMRwwGgYJKoZIhvcNAQkBFg1yZUBwYXlwYWwuY29tMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDBR07d/ETMS1ycjtkpkvjXZe9k+6CieLuLsPumsJ7QC1odNz3sJiCbs2wC0nLE0uLGaEtXynIgRqIddYCHx88pb5HTXv4SZeuv0Rqq4+axW9PLAAATU8w04qqjaSXgbGLP3NmohqM6bV9kZZwZLR/klDaQGo1u9uDb9lr4Yn+rBQIDAQABo4HuMIHrMB0GA1UdDgQWBBSWn3y7xm8XvVk/UtcKG+wQ1mSUazCBuwYDVR0jBIGzMIGwgBSWn3y7xm8XvVk/UtcKG+wQ1mSUa6GBlKSBkTCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb22CAQAwDAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQUFAAOBgQCBXzpWmoBa5e9fo6ujionW1hUhPkOBakTr3YCDjbYfvJEiv/2P+IobhOGJr85+XHhN0v4gUkEDI8r2/rNk1m0GA8HKddvTjyGw/XqXa+LSTlDYkqI8OwR8GEYj4efEtcRpRYBxV8KxAW93YDWzFGvruKnnLbDAF6VR5w/cCMn5hzGCAZowggGWAgEBMIGUMIGOMQswCQYDVQQGEwJVUzELMAkGA1UECBMCQ0ExFjAUBgNVBAcTDU1vdW50YWluIFZpZXcxFDASBgNVBAoTC1BheVBhbCBJbmMuMRMwEQYDVQQLFApsaXZlX2NlcnRzMREwDwYDVQQDFAhsaXZlX2FwaTEcMBoGCSqGSIb3DQEJARYNcmVAcGF5cGFsLmNvbQIBADAJBgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0BCQUxDxcNMTUwODE5MDc1MzE3WjAjBgkqhkiG9w0BCQQxFgQUsXnhP30X5lXGebGOS2fdDPexRvkwDQYJKoZIhvcNAQEBBQAEgYA0N6ZlNqqG9IAz1pYrYDycdAEq+/yoerwDArstomz/sTezCpRhTgm9S5cSTyFdjBRKjRwWksTzOQLIBkoIR8lDwAD3uz8NWEI2Yzbl0B5GyND7zJ4qpjrSjcyHRHigDjZQaeFmB2tsN2nu3vTCSIQjN1zwGgcyy3hP3/vCc3dliw==-----END PKCS7-----"> <input type=image src=https://www.paypalobjects.com/en_US/i/btn/btn_donate_LG.gif border=0 name=submit alt="PayPal - The safer, easier way to pay online!"> <img alt border=0 src=https://www.paypalobjects.com/en_US/i/scr/pixel.gif width=1 height=1></form>'),$templateCache.put("app/common/soulsPerSecond.template.html","<mini-soul></mini-soul>[[PS]]"),$templateCache.put("app/common/toast.template.html","<md-toast layout=row class=md-center ng-controller=ToastController><img class=toast-icon ng-src={{icon}}><div flex layout=column><div class=toast-title>{{title}}</div><div class=toast-text ng-bind-html=text></div></div><div><md-button class=narrow-button ng-click=hide()>&times;</md-button></div></md-toast>"),$templateCache.put("app/monster/army.template.html","<div layout-fill class=\"army-base fullHeight\" ng-style=\"{'background-image': 'url(\\'{{monster.background}}\\')'}\" layout=row layout-align=\"start center\" flex><div class=army-amount flex=10>{{amount}}&nbsp;x</div><div flex layout=row class=army-pics-wrapper><div ng-repeat=\"i in range track by $index\" class=army-soldier ng-style=\"{'background-image': 'url(\\'{{monster.image}}\\')'}\" flex></div></div></div>"),$templateCache.put("app/monster/monster-info.template.html",'<md-card><md-card-content><div><span ng-bind-html="\'common.income_one\' | i18n:incomeOneParameters | miniSoul"></span></div></md-card-content></md-card><div layout=row class=monster-info-stats-container><md-card flex><md-card-content><div class=monster-info-title>[[monsterOne]]</div><div>[[harvest]]: {{incomeOneNumber}}<souls-per-second></souls-per-second></div><modifier-effects modifier=monster.oneBonusModifier></modifier-effects></md-card-content></md-card><md-card flex><md-card-content><div class=monster-info-title>[[monsterArmy]]</div><div>[[harvest]]: {{formattedSPS}}<souls-per-second></souls-per-second></div><modifier-effects modifier=monster.bulkBonusModifier></modifier-effects></md-card-content></md-card></div><div layout=row><md-button class="md-raised md-primary buy-button" ng-click=ctrl.hireClicked() ng-disabled=!monster.canHire flex>[[hire]] 1<br>{{formatNumber(monster.price)}}<mini-soul></mini-soul></md-button><md-button class="md-raised md-primary buy-button" ng-click=ctrl.hireTenClicked() ng-disabled=!monster.canHireTen flex>[[hire]] 10<br>{{formatNumber(monster.priceTen)}}<mini-soul></mini-soul></md-button><md-button class="md-raised md-primary buy-button" ng-click=ctrl.fireClicked() ng-disabled="monster.ownedCount == 0" flex>[[fire]]<br>{{formatNumber(monster.priceSell)}}<mini-soul></mini-soul></md-button></div><div class=caption-with-help><h2>[[perks]]</h2><md-button class="md-raised md-primary narrow-button"><md-tooltip>[[perksHelp]]</md-tooltip>?</md-button></div><div class=perks-master-container><div ng-repeat="tier in state.getMonsterPerks(monster.id).perkTiers"><perk-tier-info tier=tier can-buy=canBuyInTier[tier.tierNumber] state=state buy-clicked=ctrl.buyPerkClicked force-refresh=ctrl.forceFillData sell-clicked=ctrl.sellPerkClicked></perk-tier-info></div></div>'),$templateCache.put("app/monster/monster.template.html","<div flex class=\"monster-selected monster-selected-{{monster.name}}\" ng-class=\"{'monster-not-selected':isSelected != 'true'}\"></div><div layout-fill ng-style=\"{'background-image': 'url(\\'{{monster.image}}\\')'}\" class=monster-bg-image layout-align=\"center bottom\" flex ng-click=onSelected() ng-class=\"['monster-card-'+monster.name]\"></div>"),$templateCache.put("app/options/options.template.html",'<md-dialog class=dialog-options><md-dialog-content><md-list><md-subheader>[[saveSubsection]]</md-subheader><md-list-item></md-list-item><md-list-item><p>[[resetProgress]]</p><md-button ng-click=ctrl.reset() class="md-raised md-primary">[[resetButton]]</md-button></md-list-item><md-list-item class=list-item-data><md-button class="md-primary md-raised" ng-click=export()>[[exportButton]]</md-button><md-input-container class=large-input><input ng-model=exportText onclick=this.select() aria-label="export text"></md-input-container></md-list-item><md-list-item class=list-item-data><md-button class="md-primary md-raised" ng-click=import()>[[importButton]]</md-button><md-input-container class=large-input><input ng-model=importText aria-label="import text"></md-input-container></md-list-item><md-list-item><p></p></md-list-item></md-list><md-list><md-subheader>[[settingsSubsection]]</md-subheader><md-list-item><p>[[language]]</p><md-select ng-model=ctrl.tr.language><md-option ng-repeat="lang in ctrl.tr.supportedLanguages" ng-value=lang ng-click=ctrl.tr.updateLocale(ctrl.tr.language)>{{lang.label}}</md-option></md-select></md-list-item><md-list-item><p>[[scale]]</p><md-select ng-model=ctrl.fm.scale><md-option ng-repeat="scale in ctrl.fm.scales" ng-value=scale>{{scale.name | i18n}}</md-option></md-select></md-list-item></md-list></md-dialog-content><div class=md-actions><md-button class="md-raised md-primary" ng-click=ctrl.close()>[[closeButton]]</md-button></div></md-dialog>'),$templateCache.put("app/options/resetConfirm.template.html",'<md-dialog><md-dialog-content>[[confirmReset]]</md-dialog-content><div class=md-actions><md-button class="md-raised md-primary" ng-click=ctrl.action()>[[yesButton]]</md-button><md-button class="md-raised md-primary" ng-click=ctrl.close()>[[noButton]]</md-button></div></md-dialog>'),$templateCache.put("app/stats/stats.template.html",'<md-dialog class=stats-dialog><md-dialog-content><md-list><md-subheader>[[gameModifiers]]</md-subheader><md-list-item><modifier-effects modifier=ctrl.options.game.state.combinedModifier></modifier-effects></md-list-item></md-list></md-dialog-content><div class=md-actions><md-button class="md-raised md-primary" ng-click=ctrl.close()>[[closeButton]]</md-button></div></md-dialog>'),$templateCache.put("app/info/info.template.html",'<div class=flex-center><div class="md-display-3 text-shadow-big info-big-title">{{title}}</div><div class="monster-count-badge md-whiteframe-z1" ng-show=count>{{count}}</div></div><div><ng-transclude></ng-transclude></div>'),$templateCache.put("app/info/modifier-effects.template.html",'<div ng-repeat="line in modifier.cachedInfo.effects">{{line.title}}<span ng-show=line.value>:</span> <span ng-class={modifierInfoRed:!line.isImprovement,modifierInfoGreen:line.isImprovement}>{{line.value}}</span></div>'),$templateCache.put("app/info/modifier-info-dialog.template.html",'<md-dialog><md-dialog-content><span class=modifier-title>{{modifier.cachedInfo.title}}</span><modifier-effects modifier=modifier></modifier-effects></md-dialog-content><div class=md-actions><md-button class="md-raised md-primary" ng-click=ctrl.close()>[[closeButton]]</md-button></div></md-dialog>'),$templateCache.put("app/info/modifier-item.template.html",'<div class=modifier-bar-wrapper><div class=modifier-bar></div></div><span><md-button class="md-primary md-raised narrow-button modifier-item-button" ng-click=showInfo($event) aria-label="Show details"><img class=modifier-icon ng-src={{modifier.getImage()}}></md-button></span>'),$templateCache.put("app/info/modifiers-info.template.html",'<div class=modifiers-wrapper><div ng-repeat="modifier in modifiers" class=modifiers-list><modifier-item class=modifier-wrapper modifier=modifier></modifier-item></div></div>'),$templateCache.put("app/info/perk-tier-info.template.html",'<h3>[[tier]] {{tier.tierNumber + 1}}</h3><div layout=row class=perks-row><div ng-repeat="perk in tier.perks" flex=45 layout=column class="perk-info md-whiteframe-z2" ng-class="{\'perk-info-cannot-buy\': !canBuy && !state.perkOwnedById[perk.id], \'perk-info-bought\':state.perkOwnedById[perk.id]}"><div class=perk-img-desc-container><img class=perk-img ng-src={{perk.getImage()}}><div class=perk-title-desc-container><span class=perk-title>{{perk.cachedInfo.title}}</span><modifier-effects modifier=perk></modifier-effects></div></div><div class=flex-center><md-button class="md-raised md-primary" ng-disabled=!perk.canAfford ng-show=canBuy ng-click=ctrl.buyClicked(perk.id)>{{formatNumber(perk.price)}}<mini-soul></mini-soul></md-button></div></div><div class="perk-info md-whiteframe-z2 flex-center" flex=45 ng-show=!canBuy><md-button class="md-raised md-primary" ng-show=!canBuy ng-click=ctrl.sellClicked(boughtPerkId)>[[sell]]</md-button></div></div>')}angular.element(document).ready(function(){var getBody;return getBody=function(){return document.querySelector("body")},compileExpressionsInElement(angular.element(getBody())),angular.bootstrap(getBody(),["soulclicker"])});var compileExpressionStrings,compileExpressionsInElement,wrapTemplateCache,wrapTemplateRequest;compileExpressionStrings=function(x){return x.replace(/\[\[([^\]]*)\]\]/g,"{{ 'common.$1' | i18n }}")},compileExpressionsInElement=function(jqElem){var e;return e=jqElem,e.html(compileExpressionStrings(e.html()))},wrapTemplateRequest=function($provide){var f;return f=function($delegate){return function(tpl,ignoreRequestError){return $delegate(tpl,ignoreRequestError).then(function(data){return compileExpressionStrings(data)},function(error,status,headers,config){return error})}},$provide.decorator("$templateRequest",["$delegate",f])},wrapTemplateCache=function($provide){var f;return f=function($delegate){return{put:function(id,value){var newValue;return newValue=_.isString(value)?compileExpressionStrings(value):value,$delegate.put(id,newValue)},get:function(id){return $delegate.get(id)}}},$provide.decorator("$templateCache",["$delegate",f])},_.decapitalize=function(x){return"string"==typeof x&&x.length>0?_.head(x).toLowerCase()+_.tail(x).join(""):x},_.round=function(x){return Math.round(x)},_.roundAndDropZeroes=function(x,decimalPlaces){var rounded;return rounded=x.toFixed(decimalPlaces),_.contains(rounded,".")?rounded.replace(/\.?0+$/,""):rounded},_.abs=function(x){return Math.abs(x)},_.updated=function(array){var i,idx,idxVal,idxVals,index,len,r,ref,val,value;if(r=array.slice(),3===arguments.length)ref=[arguments[1],arguments[2]],index=ref[0],value=ref[1],r[index]=value;else{if(2!==arguments.length||!_.isArray(arguments[1]))throw new Error("Invalid agruments - "+JSON.stringify(arguments)+".");for(idxVals=arguments[1],i=0,len=idxVals.length;len>i;i++)idxVal=idxVals[i],idx=idxVal[0],val=idxVal[1],r[idx]=val}return r},angular.module("soulclicker",["ngMaterial","ngSanitize","ngLocalize","ngLocalize.Config","ngLocalize.InstalledLanguages","digestHud","LocalStorageModule"]).config(["$mdThemingProvider",function($mdThemingProvider){return $mdThemingProvider.theme("default").primaryPalette("purple").backgroundPalette("grey").dark()}]).value("localeConf",{basePath:"languages",defaultLocale:"en-US",sharedDictionary:"common",fileExtension:".lang.json",persistSelection:!0,cookieName:"COOKIE_LOCALE_LANG",observableAttrs:new RegExp("^data-(?!ng-|i18n)"),delimiter:"::"}).value("localeSupported",["en-US","cs-CZ "]).value("localeFallbacks",{en:"en-US",cs:"cs-CZ"}).run(function(){return window.sc?window.sc.loaded=!0:console.log("In run is not initialized window.sc?"),doBrowserCheck()}).config(["$provide",function($provide){return wrapTemplateRequest($provide),wrapTemplateCache($provide)}]).config(["digestHudProvider",function(digestHudProvider){return""}]).config(["localStorageServiceProvider",function(localStorageServiceProvider){return localStorageServiceProvider.setPrefix("soulclicker")}]).run(["$templateCache",function($templateCache){return initializeTemplates($templateCache)}]),window.sc&&console.log("Warning: multiple module execution detected!"),window.sc={loaded:!1},angular.module("soulclicker").controller("AboutDialogController",["$mdDialog",function($mdDialog){this.close=function(){return $mdDialog.hide()}}]);var showAboutDialog;showAboutDialog=function(customDialog,$event,options){return options.event=$event,customDialog.show({parent:angular.element(document.body),targetEvent:$event,templateUrl:"app/about/about.template.html",controller:"AboutDialogController",controllerAs:"ctrl",locals:{options:options},bindToController:!0})},angular.module("soulclicker").service("animation",function(){this.animationPileSelector="#animationPile",this.spawnSoulHarvestedFloat=function(_this){return function(x,y,text,slideAmount){var elem;return null==slideAmount&&(slideAmount=20),elem=$("<span/>").addClass("animation-souls-float"),$(_this.animationPileSelector).append(elem),elem.html(text),elem.css("left",x-elem.width()/2).css("top",y-elem.height()/2),elem.velocity({opacity:0,top:"-="+slideAmount},1500,function(){return elem.remove()})}}(this),this.spawnSoulHarvestedFloatFromElement=function(e,text,offsetX,offsetY){var elem,offset,x,y;return null==offsetX&&(offsetX=0),null==offsetY&&(offsetY=0),elem=e.isElementGeometry?e:$(e),offset=elem.offset(),x=offset.left+elem.width()/2+offsetX,y=offset.top+elem.height()/2+offsetY,this.spawnSoulHarvestedFloat(x,y,text,elem.height()/2)},this.spawnSoulHarvestedFloatFromArmy=function(id,text){var army,soldiers;return army=$("#army_"+id),soldiers=army.find(".army-soldier"),0===soldiers.size()?console.log("this is weird, soldiers size is zero - id="+id+", text="+text):this.spawnSoulHarvestedFloatFromElement(_(soldiers).take(6).sample(),text)},this.spawnCard=function(_this){return function(name,x,y,cardName,center){var elem,inRot,inYoff,leftFix,slideAmount,topFix;return null==center&&(center=!0),slideAmount=50,inRot=65,inYoff=60,elem=$("<span/>").addClass("animation-bonus-card"),$(_this.animationPileSelector).append(elem),leftFix=center?-elem.width():0,topFix=center?-elem.height()/2:0,elem.css("left",x-slideAmount+leftFix).css("top",y+inYoff+topFix).css("opacity",0).css("background-image","url('images/bonus_card_"+cardName+"_back.png')"),elem.velocity({opacity:1,left:"+="+2*slideAmount,rotateZ:["0deg","-"+inRot+"deg"],top:"-="+inYoff},300).delay(50).velocity({rotateY:["90deg","0deg"]},200,function(){return elem.css("background-image","url('images/bonus_card_"+name+".png')")}).velocity({rotateY:"0deg"},200).delay(500).velocity({opacity:0,top:"+="+slideAmount,rotateZ:"10deg"},1500,function(){return elem.remove()})}}(this)}),angular.module("soulclicker").service("autoSave",["$interval","gameStatePersistence","toast",function($interval,gameStatePersistence,toast){this.autoSaveInterval=3e5,this.state={},this.planSaving=function(_this){return function(state){_this.state=state,$interval(function(){return _this.autoSave()},_this.autoSaveInterval)}}(this),this.autoSave=function(_this){return function(){gameStatePersistence.save(_this.state),toast.showGameSaved()}}(this)}]),angular.module("soulclicker").service("customDialog",["utils","$mdDialog",function(utils,$mdDialog){this.show=function(_this){return function(obj){return null!=obj.templateUrl&&(obj.template=utils.localizeTemplateUrl(obj.templateUrl),delete obj.templateUrl),$mdDialog.show(obj)}}(this)}]),angular.module("soulclicker").directive("donate",function(){return{templateUrl:"app/common/donate.template.html"}});var Scale,ScientificScale,TenPoweredByThreesScale,extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;angular.module("soulclicker").service("format",["utils",function(utils){var scaleLong,scaleMetricLong,scaleMetricShort,scaleShort,scaleShortShort;scaleShort=["thousand","million","billion","trillion","quadrillion","quintillion"],scaleShortShort=["th","mi","bi","tr","qd","qt"],scaleLong=["thousand","million","milliard","billion","billiard","trillion"],scaleMetricLong=["kilo","mega","giga","tera","peta","exa"],scaleMetricShort=["k","M","G","T","P","E"],this.scales=[new TenPoweredByThreesScale("short_long",scaleShort),new TenPoweredByThreesScale("short_short",scaleShortShort),new TenPoweredByThreesScale("long_long",scaleLong),new TenPoweredByThreesScale("metric_long",scaleMetricLong),new TenPoweredByThreesScale("metric_short",scaleMetricShort),new ScientificScale("scientific")],this.scale=_.first(this.scales),this.formatNumber=function(_this){return function(number,floor){return _this.scale.format(number,utils.translate,floor)}}(this),this.printTranslationData=function(){return _.each(this.scales,function(x){return x.printTranslationData()})}}]),Scale=function(){function Scale(name){this.name="common.scale_"+name}return Scale.decimalPlaces=3,Scale.prototype.format=function(number,i18n,floor){return null==floor&&(floor=!0),0>=number?"0":floor?Math.floor(number):Number(number).toFixed(Scale.decimalPlaces)},Scale}(),ScientificScale=function(superClass){function ScientificScale(name){ScientificScale.__super__.constructor.call(this,name)}return extend(ScientificScale,superClass),ScientificScale.prototype.format=function(number,i18n){var base,log;return 0>=number?(log=0,base=1,number=0):(log=Math.floor(Math.log10(number)),base=Math.pow(10,log)),Number(number/base).toFixed(Scale.decimalPlaces)+"e"+log},ScientificScale}(Scale),TenPoweredByThreesScale=function(superClass){function TenPoweredByThreesScale(name,valueNames,insertSpace){this.insertSpace=null!=insertSpace?insertSpace:!0,TenPoweredByThreesScale.__super__.constructor.call(this,name),this.valueNames=_.map(valueNames,function(_this){return function(x){return _this.name+"_"+x}}(this))}return extend(TenPoweredByThreesScale,superClass),TenPoweredByThreesScale.prototype.format=function(number,i18n,floor){var flooredLog,log,logThird,maxIndex,numToShow,valueBase,valueIndex;return null==floor&&(floor=!0),0>=number?"0":(log=Math.log10(number),flooredLog=Math.floor(log),logThird=Math.floor(flooredLog/3),valueIndex=logThird-1,maxIndex=this.valueNames.length-1,valueIndex>maxIndex&&(valueIndex=maxIndex),0>valueIndex?TenPoweredByThreesScale.__super__.format.call(this,number,i18n,floor):(valueBase=Math.pow(10,3*(valueIndex+1)),numToShow=Number(number/valueBase).toFixed(Scale.decimalPlaces),numToShow+this.getDelimiter()+i18n(this.valueNames[valueIndex])))},TenPoweredByThreesScale.prototype.getDelimiter=function(){return this.insertSpace?" ":""},TenPoweredByThreesScale.prototype.printTranslationData=function(){var data;return data=_.map(this.valueNames,function(x){return'"'+x+'":"'+_.last(x.split("_"))+'",'}),console.log(data.join("\n"))},TenPoweredByThreesScale}(Scale),angular.module("soulclicker").directive("mail",function(){return{template:'<md-icon md-svg-icon="images/envelope.svg"\n         class="mail-img"\n         ng-click="open()"></md-icon>',scope:{target:"@"},controller:["$scope",function($scope){var demangle;return demangle=function(x){return _(x.split("  ")).reverse().map(function(x){return x.replace(/\ /g,".").replace(/@/g,"")}).join("@")},$scope.open=function(_this){return function(){return window.open("mailto:"+demangle($scope.target),"_blank")}}(this)}]}}),angular.module("soulclicker").directive("miniSoul",function(){return{restrict:"EA",template:"<span ng-bind-html=\"'%SOUL%' | miniSoul\"></span>"}});var MiniSoulHtml;MiniSoulHtml='<img class="miniSoul" src="images/miniSoul.png">',angular.module("soulclicker").filter("miniSoul",function(){return function(data){return data.replace(/%SOUL%/g,MiniSoulHtml)}});var doBrowserCheck;doBrowserCheck=function(){return bowser.msie&&bowser.version<11?alert("Please update your Internet Explorer browser, this application is not built to run on ancient software. Expect bugs."):void 0},angular.module("soulclicker").service("optionsPersistence",["localStorageService","translation","format","perks",function(localStorageService,translation,format,perks){var keyName;keyName="options",this.saveOptions=function(_this){return function(){var langIndex,obj,scaleIndex;return langIndex=_.indexOf(translation.supportedLanguages,translation.language),scaleIndex=_.indexOf(format.scales,format.scale),obj={langIndex:langIndex,scaleIndex:scaleIndex},localStorageService.set(keyName,obj)}}(this),this.loadOptions=function(_this){return function(){var obj;return obj=localStorageService.get(keyName),null!=obj?(translation.language=translation.supportedLanguages[obj.langIndex],format.scale=format.scales[obj.scaleIndex],translation.updateLocale()):void 0}}(this)}]),angular.module("soulclicker").directive("soulsPerSecond",function(){return{restrict:"EA",templateUrl:"app/common/soulsPerSecond.template.html"}}),angular.module("soulclicker").service("toast",["utils","format","$mdToast","$timeout",function(utils,format,$mdToast,$timeout){this.getToastElem=function(){return $("md-toast")},this.showSimple=function(text){return $mdToast.show($mdToast.simple(text))},this.last=null,this.queue=[],this.showGameSaved=function(_this){return function(){return _this.showLocalized("common.gameSaved","","images/gameSaved.png")}}(this),this.showLocalized=function(_this){return function(titleKey,textKey,icon,textParams,titleParams){return _this.show(utils.translate(titleKey,titleParams),utils.translate(textKey,textParams),icon)}}(this),this.show=function(_this){return function(title,text,icon){return null==_this.last?(_this.last=$mdToast.show({templateUrl:"app/common/toast.template.html",hideDelay:!1,position:"bottom",controller:["$scope","toast",function($scope,toast){$scope.text=text,$scope.title=title,$scope.icon=icon,$scope.hideToast=$mdToast.hide}]}),_this.last.then(function(){return _this.last=null,_this.nextItem=_this.queue.shift(),_this.nextItem?_this.show.apply(_this,_this.nextItem):void 0})):_this.queue.length>5?console.warn('Toast queue is too long, thrashing "'+title+'".'):_this.queue.push([title,text,icon])}}(this)}]).controller("ToastController",["$element","$timeout","$scope","toast",function($element,$timeout,$scope,toast){var hideAnimation,t;$element.removeData(),$element.velocity({opacity:[1,0],translateY:[0,200]},500),hideAnimation=function(elem){var doHiding;return doHiding=function(){return $scope.hideToast()},$element.find("button").attr("disabled",!0),elem.velocity({opacity:[0,1],translateY:[200,0]},500,doHiding)},t=$timeout(function(){return hideAnimation($element)},5e3),$scope.hide=function(){$timeout.cancel(t),hideAnimation($element)}}]),angular.module("soulclicker").service("translation",["locale",function(locale){this.translate=function(id,params){return locale.getString(id,params)},this.afterTranslateReady=function(f){return locale.ready("common").then(f)},this.translatePromise=function(_this){return function(id,params){return _this.afterTranslateReady(function(){return locale.getString(id,params)})}}(this),this.supportedLanguages=[{label:"English",value:"en-US"},{label:"Čeština",value:"cs-CZ"}],this.language=_.first(this.supportedLanguages),this.updateLocale=function(_this){return function(){return locale.setLocale(_this.language.value)}}(this),this.getLocale=locale.getLocale}]),angular.module("soulclicker").service("utils",["$filter","$templateRequest","translation",function($filter,$templateRequest,translation){this.range=function(n){return _.range(n)},this.translate=translation.translate,this.afterTranslateReady=translation.afterTranslateReady,this.translatePromise=translation.translatePromise,this.getOffset=function(e){var offsetX,offsetY,rect,target;return target=e.target||e.srcElement,rect=target.getBoundingClientRect(),offsetX=e.clientX-rect.left,offsetY=e.clientY-rect.top,{x:offsetX,y:offsetY}},this.zipWithIndex=function(a){var f;return f=function(acc,item){return{idx:acc.idx+1,res:acc.res.concat([[item,acc.idx]])}},_(a).reduce(f,{idx:0,res:[]}).res},this.setRandomPosition=function(border,size,elem){var left,top;return left=_.random(border,100-border-size),top=_.random(border,100-border-size),elem.css("left",left+"vw").css("top",top+"vh")},this.formatDoubleDigitNumber=function(num){return 10>num?"0"+num:num+""},this.formatTime=function(_this){return function(date){return date.getHours()+":"+_this.formatDoubleDigitNumber(date.getMinutes())+":"+_this.formatDoubleDigitNumber(date.getSeconds())}}(this),this.formatCurrentTime=function(_this){return function(){return _this.formatTime(new Date)}}(this),this.localizeTemplateUrl=function(_this){return function(url){return $templateRequest(url).then(function(x){return compileExpressionStrings(x)})}}(this)}]);var Bonus,BonusCards,BonusCardsHell,BonusCardsNormal,BonusManager,ElementGeometry,extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;BonusManager=function(){function BonusManager(game1){var ref;this.game=game1,ref=[this.game.$interval,this.game.$timeout],this.$interval=ref[0],this.$timeout=ref[1],this.spawnTimeout=null,this.stopSpawningTimer(),this.clearDespawnTimer(),this.bonusList=[new BonusCardsNormal,new BonusCardsHell],this.currentBonus=null,this.bonusElem=null,this.state=this.game.state,this.forceNextSpawnInstant=!1,this.debug=!0,this.printDebug=function(_this){return function(msg){return _this.debug?_this.game.printDebug(msg):void 0}}(this)}return BonusManager.prototype.startSpawningTimer=function(){var delay,percentSpawnVariance;return this.printDebug("starting spawn timer"),null!==this.spawnTimeout?this.printDebug("spawn timer already running, skipping spawning"):(percentSpawnVariance=.3,delay=_.round(this.state.getBonusSpawnDelay()*_.random(1-percentSpawnVariance,1+percentSpawnVariance)),this.forceNextSpawnInstant&&(this.forceNextSpawnInstant=!1,delay=0),this.spawnTimeout=this.$timeout(function(_this){return function(){return _this.spawnBonus()}}(this),delay))},BonusManager.prototype.stopSpawningTimer=function(){return null!=this.spawnTimeout&&this.$timeout.cancel(this.spawnTimeout),this.spawnTimeout=null},BonusManager.prototype.startDespawnTimer=function(){return this.despawnTimeout=this.$timeout(function(_this){return function(){return _this.startDespawningBonus()}}(this),this.state.getBonusDespawnDelay())},BonusManager.prototype.clearDespawnTimer=function(){return null!=this.despawnTimeout&&this.$timeout.cancel(this.despawnTimeout),this.despawnTimeout=null},BonusManager.prototype.reset=function(){return this.clearDespawnTimer(),this.stopSpawningTimer(),this.getPile().empty(),this.startSpawningTimer()},BonusManager.prototype.getPile=function(){return $("#bonusPile")},BonusManager.prototype.spawnBonus=function(){var done;return this.stopSpawningTimer(),this.currentBonus=game.state.combinedModifier.getEnablesHellCards()?_.sample(this.bonusList):this.bonusList[0],this.printDebug("spawning a bonus!"),this.bonusElem=this.currentBonus.createElement().css("opacity",0),this.game.utils.setRandomPosition(10,10,this.bonusElem),done=function(_this){return function(){return _this.startSpawningTimer()}}(this),this.bonusElem.click(function(_this){return function(){return _this.clearDespawnTimer(),_this.currentBonus.activate(_this.game,_this.bonusElem,done),_this.despawnBonus()}}(this)),this.getPile().append(this.bonusElem),this.bonusElem.animate({opacity:1},1e3,function(_this){return function(){}}(this)),this.startDespawnTimer()},BonusManager.prototype.startDespawningBonus=function(){return null!=this.bonusElem?this.bonusElem.velocity({opacity:0},1e3,function(_this){return function(){return null!=_this.bonusElem?(_this.despawnBonus(),
_this.startSpawningTimer()):void 0}}(this)):void 0},BonusManager.prototype.despawnBonus=function(){return this.printDebug("trying to despawn bonus ("+this.bonusElem+")"),null!=this.bonusElem?(this.bonusElem.remove(),this.bonusElem=null):void 0},BonusManager}(),Bonus=function(){function Bonus(name){this.name=name}return Bonus.prototype.getImage=function(){return"images/bonus_"+this.name+".png"},Bonus.prototype.getWidth=function(){return 15},Bonus.prototype.getHeight=function(){return 10},Bonus.prototype.getSize=function(){return{width:this.getWidth(),height:this.getHeight()}},Bonus.prototype.createElement=function(){return $("<div/>").addClass("bonus").css("width",this.getWidth()+"vw").css("height",this.getHeight()+"vw").css("background-image","url('"+this.getImage()+"')")},Bonus.prototype.getEffects=function(){return[]},Bonus.prototype.activate=function(game,elem,done){var effect,effects,id,ref;if(null==elem)throw $("bonus").remove(),new Error("Undefined element!");return effects=this.getEffects(),ref=_(effects).thru(game.utils.zipWithIndex).sample(),effect=ref[0],id=ref[1],this.activateEffect(game,elem,effect,id,done)},Bonus.prototype.activateEffect=function(game,elem,effect,id,done){if(null==done)throw new Error("Undefined done handler");return effect.activate(game,elem,done)},Bonus}(),ElementGeometry=function(){function ElementGeometry(elem){this.isElementGeometry=!0,function(_this){return function(offset,width,height){return _this.offset=function(){return offset},_this.width=function(){return width},_this.height=function(){return height}}}(this)(elem.offset(),elem.width(),elem.height())}return ElementGeometry}(),BonusCards=function(superClass){function BonusCards(){return BonusCards.__super__.constructor.apply(this,arguments)}return extend(BonusCards,superClass),BonusCards.prototype.activateEffect=function(game,elem,effect,id,done){var fakeElem,offset;return offset=elem.offset(),fakeElem=new ElementGeometry(elem),elem=null,game.$timeout(function(_this){return function(){return BonusCards.__super__.activateEffect.call(_this,game,fakeElem,effect,id,done)}}(this),1e3),game.animation.spawnCard(effect.name,offset.left+fakeElem.width()/2+_.random(-20,20),offset.top+fakeElem.height()/2+_.random(-20,20),this.name)},BonusCards}(Bonus),BonusCardsNormal=function(superClass){function BonusCardsNormal(){BonusCardsNormal.__super__.constructor.call(this,"cardsNormal")}return extend(BonusCardsNormal,superClass),BonusCardsNormal.prototype.getEffects=function(){return[new HardWorkBonusEffect,new SlavishWorkBonusEffect,new CatastropheBonusEffect]},BonusCardsNormal}(BonusCards),BonusCardsHell=function(superClass){function BonusCardsHell(){BonusCardsHell.__super__.constructor.call(this,"cardsHell")}return extend(BonusCardsHell,superClass),BonusCardsHell.prototype.getEffects=function(){return[new TheftBonusEffect,new SoulLeakBonusEffect,new AlertedCitizensBonusEffect]},BonusCardsHell}(BonusCards);var AlertedCitizensBonusEffect,BonusEffect,CatastropheBonusEffect,ClickableSoulsBonusEffect,HardWorkBonusEffect,SlavishWorkBonusEffect,SoulLeakBonusEffect,SoulsBonusEffect,TheftBonusEffect,extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;BonusEffect=function(){function BonusEffect(name1){this.name=name1}return BonusEffect.prototype.activate=function(game,elem,done){throw new Error("not implemented yet")},BonusEffect.prototype.showToast=function(game,params,langItemId){var name,tr;return tr=game.utils.translate,name=this.name,null!=langItemId&&(name+="_"+langItemId),game.toast.show(tr("common.bonus_"+name+"_title"),tr("common.bonus_"+name+"_text",params),this.getIcon())},BonusEffect.prototype.getIcon=function(){return"images/bonus_effect_"+this.name+".png"},BonusEffect}(),SoulsBonusEffect=function(superClass){function SoulsBonusEffect(){return SoulsBonusEffect.__super__.constructor.apply(this,arguments)}return extend(SoulsBonusEffect,superClass),SoulsBonusEffect.prototype.activate=function(game,elem,done){var amount;return amount=this.calculateAmount(game),game.animation.spawnSoulHarvestedFloatFromElement(elem,game.genSoulHtml(amount)),amount>0?game.state.addSouls(amount):game.state.removeSouls(-amount),this.showToast(game,{souls:game.genSoulHtml(_.abs(amount),0>amount)},amount>0?0:1),done()},SoulsBonusEffect.prototype.calculateAmount=function(game){return console.log("Warning: calculateAmount not implemented in "+this.constructor.name),0},SoulsBonusEffect}(BonusEffect),HardWorkBonusEffect=function(superClass){function HardWorkBonusEffect(){HardWorkBonusEffect.__super__.constructor.call(this,"hardWork")}return extend(HardWorkBonusEffect,superClass),HardWorkBonusEffect.prototype.calculateAmount=function(game){return _.random(20,60)*_.max([game.state.soulsPerClick,1])*10},HardWorkBonusEffect}(SoulsBonusEffect),SlavishWorkBonusEffect=function(superClass){function SlavishWorkBonusEffect(){SlavishWorkBonusEffect.__super__.constructor.call(this,"slavishWork")}return extend(SlavishWorkBonusEffect,superClass),SlavishWorkBonusEffect.prototype.calculateAmount=function(game){return _.random(20,60)*_.max([game.state.soulsPerSecond,1])},SlavishWorkBonusEffect}(SoulsBonusEffect),ClickableSoulsBonusEffect=function(superClass){function ClickableSoulsBonusEffect(name){ClickableSoulsBonusEffect.__super__.constructor.call(this,name),this.customToast=!1}return extend(ClickableSoulsBonusEffect,superClass),ClickableSoulsBonusEffect.prototype.getMinTimeToLive=function(){return 3e3},ClickableSoulsBonusEffect.prototype.getMaxTimeToLive=function(){return 5e3},ClickableSoulsBonusEffect.prototype.getMaxSpawnDelay=function(){return 3e3},ClickableSoulsBonusEffect.prototype.getAmount=function(){return 10},ClickableSoulsBonusEffect.prototype.getMaxAmountBonus=function(){return 7},ClickableSoulsBonusEffect.prototype.getBaseSize=function(){return 5},ClickableSoulsBonusEffect.prototype.getMaxSoulSize=function(){return 2},ClickableSoulsBonusEffect.prototype.getMinDespawningTime=function(){return 1e3},ClickableSoulsBonusEffect.prototype.getMaxDespawningTime=function(){return 3e3},ClickableSoulsBonusEffect.prototype.getPile=function(){return $("#bonusPile")},ClickableSoulsBonusEffect.prototype.spawnCatastropheSoul=function(game,size,soulContentsAmount){var cssSize,elem;return cssSize=this.getBaseSize()+size+"vw",elem=$("<span/>").addClass("animation-bonus-catastrophe-soul").css("width",cssSize).css("height",cssSize).css("opacity",0).data("size",size),game.utils.setRandomPosition(10,10,elem),elem.data("amount",soulContentsAmount),this.getPile().append(elem),elem},ClickableSoulsBonusEffect.prototype.startDespawningCatastropheSoul=function(elem){return elem.velocity({opacity:0,top:"-=100"},_.random(this.getMinDespawningTime(),this.getMaxDespawningTime()),function(){return elem.remove()})},ClickableSoulsBonusEffect.prototype.catastropheSoulClicked=function(game,elem){var amount,htmlSouls;return elem.hasClass("clicked")?void 0:(elem.velocity("stop"),amount=elem.data("amount"),htmlSouls=game.genSoulHtml(amount),game.animation.spawnSoulHarvestedFloatFromElement(elem,htmlSouls),game.state.addSouls(amount),elem.addClass("clicked"),elem.velocity({opacity:0,scale:.5},250,function(){return elem.remove()}))},ClickableSoulsBonusEffect.prototype.activate=function(game,elem,done){var amount,doneDelay,fn,i,k,ref,results,sizes,soul,soulContentsAmounts,timeout;for(timeout=game.$timeout,this.customToast||this.showToast(game,{}),amount=this.getAmount()+_.random(this.getMaxAmountBonus(),!1),sizes=_.map(function(){results=[];for(var j=0;amount>=0?amount>j:j>amount;amount>=0?j++:j--)results.push(j);return results}.apply(this),function(_this){return function(){return _.random(0,_this.getMaxSoulSize())}}(this)),soulContentsAmounts=this.generateSoulContentsAmounts(game,sizes),fn=function(_this){return function(soul){return soul.click(function(){return _this.catastropheSoulClicked(game,soul)}),timeout(function(){return soul.velocity({opacity:[1,0],scale:[1,0]},_.random(250,750))},_.random(_this.getMaxSpawnDelay())),timeout(function(){return _this.startDespawningCatastropheSoul(soul)},_.random(_this.getMinTimeToLive(),_this.getMaxTimeToLive()))}}(this),i=k=0,ref=amount;ref>=0?ref>k:k>ref;i=ref>=0?++k:--k)soul=this.spawnCatastropheSoul(game,sizes[i],soulContentsAmounts[i]),fn(soul);return doneDelay=this.getMaxTimeToLive()+this.getMaxSpawnDelay()+this.getMaxDespawningTime(),timeout(function(){return done()},doneDelay)},ClickableSoulsBonusEffect}(BonusEffect),CatastropheBonusEffect=function(superClass){function CatastropheBonusEffect(){CatastropheBonusEffect.__super__.constructor.call(this,"catastrophe")}return extend(CatastropheBonusEffect,superClass),CatastropheBonusEffect.prototype.generateSoulContentsAmounts=function(game,sizes){return _.map(sizes,function(_this){return function(size){var sizeCoef;return sizeCoef=1+size/_this.getMaxSoulSize()*.33,sizeCoef*_.random(2,6)*_.max([game.state.soulsPerSecond,1])}}(this))},CatastropheBonusEffect}(ClickableSoulsBonusEffect),TheftBonusEffect=function(superClass){function TheftBonusEffect(){TheftBonusEffect.__super__.constructor.call(this,"theft")}return extend(TheftBonusEffect,superClass),TheftBonusEffect.prototype.calculateAmount=function(game){var max,v;return max=60*game.state.soulsPerSecond*5,v=-1*game.state.bank*_.random(.1,.95)*game.state.combinedModifier.getTheftCoef(),v>0?_.min([max,v]):v},TheftBonusEffect}(SoulsBonusEffect),SoulLeakBonusEffect=function(superClass){function SoulLeakBonusEffect(){SoulLeakBonusEffect.__super__.constructor.call(this,"soulLeak"),this.customToast=!0,this.timeCoef=1}return extend(SoulLeakBonusEffect,superClass),SoulLeakBonusEffect.prototype.getMaxAmountBonus=function(){return 0},SoulLeakBonusEffect.prototype.getMinTimeToLive=function(){return 1e3*this.timeCoef},SoulLeakBonusEffect.prototype.getMaxTimeToLive=function(){return 3e3*this.timeCoef},SoulLeakBonusEffect.prototype.getMaxDespawningTime=function(){return 1500*this.timeCoef},SoulLeakBonusEffect.prototype.generateSoulContentsAmounts=function(game,sizes){var parts,totalParts;return parts=_.map(sizes,function(a){return a+1}),totalParts=_.sum(parts),_.map(parts,function(_this){return function(x){return _this.soulsToLeak*x/totalParts}}(this))},SoulLeakBonusEffect.prototype.activate=function(game,elem,done){var perClickPart,perSecondPart;return perSecondPart=_.random(3,10)*_.max([game.state.soulsPerSecond,1]),perClickPart=_.random(100,300)*_.max([game.state.soulsPerClick,2]),this.soulsToLeak=_.min([game.state.bank,perSecondPart+perClickPart]),game.state.removeSouls(this.soulsToLeak),game.animation.spawnSoulHarvestedFloatFromElement(elem,game.genSoulHtml(-this.soulsToLeak)),this.showToast(game,{souls:game.genSoulHtml(_.abs(this.soulsToLeak),!0)}),this.timeCoef=game.state.combinedModifier.getSoulLeakTimeCoef(),SoulLeakBonusEffect.__super__.activate.call(this,game,elem,done)},SoulLeakBonusEffect}(ClickableSoulsBonusEffect),AlertedCitizensBonusEffect=function(superClass){function AlertedCitizensBonusEffect(){AlertedCitizensBonusEffect.__super__.constructor.call(this,"alertedCitizens")}return extend(AlertedCitizensBonusEffect,superClass),AlertedCitizensBonusEffect.prototype.activate=function(game,elem,done){return this.showToast(game,{}),game.state.addModifier(new AlertedCitizensModifier(game.state.combinedModifier.getPeopleAlertedTimeCoef()))},AlertedCitizensBonusEffect}(BonusEffect),angular.module("soulclicker").controller("GameCtrl",["$interval","monsters","animation","format","$mdDialog","$timeout","toast","utils","perks","customDialog","$scope","localStorageService","optionsPersistence","gameStatePersistence","autoSave","locale","localeEvents",function($interval,monsters,animation,format,$mdDialog,$timeout,toast,utils,perks,customDialog,$scope,localStorageService,optionsPersistence,gameStatePersistence,autoSave,locale,localeEvents){var optionsDialogOptions;this.printIntroduction=function(){var s;return s="color:#7A1053; font-weight:bold; font-size:120%",console.log("%cSoul Clicker","color: #333; text-shadow: 0px 1px 0 gray; font-size:200%; font-weight:bold;"),console.log("by %cMartin Kučera%c and %cRadek Kučera",s,"",s)},this.printIntroduction(),this.printDebug=function(_this){return function(msg){return _this.debug?console.log("["+_this.utils.formatCurrentTime()+"]: "+msg):void 0}}(this),localStorageService.isSupported||console.warn("Local storage is not available, saving data to cookies might be unreliable."),window.game=this,this.animation=animation,this.toast=toast,this.utils=utils,this.$timeout=$timeout,this.$interval=$interval,this.gameStatePersistence=gameStatePersistence,this.autoSave=autoSave,this.debug=!1,this.monsterService=monsters,this.perksService=perks,this.state=new GameState(monsters,perks,utils),this.bonusManager=new BonusManager(this),this.setSelectedMonster=function(_this){return function(id){return _this.selectedMonster=_this.state.monsters[id]}}(this),this.reset=function(_this){return function(){return _this.state.reset(),_this.setSelectedMonster(Monster.GhoulId),_this.bonusManager.reset()}}(this),this.reset(),gameStatePersistence.load(this.state),autoSave.planSaving(this.state),this.genSoulHtml=function(n,forceNegativeColor){var classes,num;return null==forceNegativeColor&&(forceNegativeColor=!1),num=format.formatNumber(_.abs(n)),0>n&&(num="-"+num),classes=["soul-number"],(0>n||forceNegativeColor)&&classes.push("soul-number-negative"),'<span class="'+classes.join(" ")+'">'+num+" "+MiniSoulHtml+"</span>"},this.bottleClicked=function(_this){return function(x,y){var slideAmount;return slideAmount=$("bottle").height()/4,animation.spawnSoulHarvestedFloat(x+_.random(-10,10),y+_.random(-5,5),_this.genSoulHtml(_this.state.addClickSouls()),slideAmount)}}(this),this.monsterClicked=function(_this){return function(monsterId){return _this.setSelectedMonster(monsterId)}}(this),this.hireClicked=function(_this){return function(){return _this.state.buyMonster(_this.selectedMonster.id)}}(this),this.hireTenClicked=function(_this){return function(){var i;for(i=1;10>=i;i++)_this.state.buyMonster(_this.selectedMonster.id);return _this.state.refreshAll()}}(this),this.fireClicked=function(_this){return function(){return _this.state.sellMonster(_this.selectedMonster.id)}}(this),this.buyPerkClicked=function(_this){return function(perkId){return _this.state.buyPerk(perkId)}}(this),this.sellPerkClicked=function(_this){return function(perkId){return _this.state.sellPerk(perkId)}}(this),this.isMonsterSelected=function(_this){return function(){return null!=_this.selectedMonster.id}}(this),this.state.initializeMonsterIntervals($interval),this.state.onMonsterHarvest=function(_this){return function(n,id){return animation.spawnSoulHarvestedFloatFromArmy(id,_this.genSoulHtml(n))}}(this),optionsDialogOptions={onResetClicked:function(_this){return function(){return _this.reset()}}(this),"export":function(_this){return function(){return gameStatePersistence["export"](_this.state)}}(this),"import":function(_this){return function(data){return gameStatePersistence["import"](_this.state,data)}}(this)},this.showOptionsDialog=function(evt){return evt.target=$(".main-menu"),showOptionsDialog(customDialog,evt,optionsDialogOptions)},this.showStatsDialog=function(_this){return function(evt){return evt.target=$(".main-menu"),showStatsDialog(customDialog,evt,{game:_this})}}(this),this.showAboutDialog=function(_this){return function(evt){return evt.target=$(".main-menu"),showAboutDialog(customDialog,evt,{})}}(this),this.save=function(_this){return function(){return gameStatePersistence.save(_this.state),toast.showGameSaved()}}(this),GameModifier.translateFunction=utils.translate,GameModifier.promiseTranslateFunction=utils.translatePromise,TimedGameModifier.$timeout=this.$timeout,$scope.$on(localeEvents.resourceUpdates,function(_this){return function(){return locale.ready("common").then(function(){return perks.queueRefreshCachedInfo(monsters),monsters.refreshAll(_this.state),_this.state.refreshCombinedModifier()})}}(this)),optionsPersistence.loadOptions()}]);var AlertedCitizensModifier,GameModifier,TimedGameModifier,extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;GameModifier=function(){function GameModifier(name){var className;this.name=name,this.cachedInfo={},null==this.name&&(className=this.constructor.name.replace(/Modifier$/,""),this.name=_.decapitalize(className))}return GameModifier.translateFunction=function(x){return"Missing translate function"},GameModifier.promiseTranslateFunction=function(x){return"Missing translate function"},GameModifier.SimpleValueMethods=["getClickBonusFlat","getClickBonusCoef","getBonusSpawnTimeCoef","getAllMonstersCostFlat","getAllMonstersCostCoef","getAllPerksCostFlat","getAllPerksCostCoef","getSoulLeakTimeCoef","getPeopleAlertedTimeCoef","getTheftCoef","getAllMonsterBonusCoef"],GameModifier.MonsterValueMethods=["getMonsterBonusFlat","getMonsterBonusCoef","getMonsterCostFlat","getMonsterCostCoef"],GameModifier.OrValueMethods=["getEnablesHellCards"],GameModifier.AllNonMonsterMethods=GameModifier.SimpleValueMethods.concat(GameModifier.OrValueMethods),GameModifier.AllMethods=GameModifier.AllNonMonsterMethods.concat(GameModifier.MonsterValueMethods),GameModifier.createArrayTemplate=function(value){return _.fill(Array(Monster.Count),value)},GameModifier.prototype.getTranslatePrefix=function(){return"common.gameModifier_"},GameModifier.prototype.getClickBonusFlat=function(){return 0},GameModifier.prototype.getClickBonusCoef=function(){return 1},GameModifier.prototype.getMonsterBonusFlat=function(){return GameModifier.createArrayTemplate(0)},GameModifier.prototype.getMonsterBonusCoef=function(){return GameModifier.createArrayTemplate(1)},GameModifier.prototype.getBonusSpawnTimeCoef=function(){return 1},GameModifier.prototype.getMonsterCostFlat=function(){return GameModifier.createArrayTemplate(0)},GameModifier.prototype.getMonsterCostCoef=function(){return GameModifier.createArrayTemplate(1)},GameModifier.prototype.getAllMonstersCostFlat=function(){return 0},GameModifier.prototype.getAllMonstersCostCoef=function(){return 1},GameModifier.prototype.getAllPerksCostFlat=function(){return 0},GameModifier.prototype.getAllPerksCostCoef=function(){return 1},GameModifier.prototype.getEnablesHellCards=function(){return!1},GameModifier.prototype.getSoulLeakTimeCoef=function(){return 1},GameModifier.prototype.getPeopleAlertedTimeCoef=function(){return 1},GameModifier.prototype.getTheftCoef=function(){return 1},GameModifier.prototype.getAllMonsterBonusCoef=function(){return 1},GameModifier.prototype.detectRenderType=function(title){return _.endsWith(title,"Flat")?"flat":_.endsWith(title,"Coef")?"coef":"bool"},GameModifier.NegatedEffectsForInfo=["bonusSpawnTimeCoef","monsterCostFlat","monsterCostCoef","allMonstersCostFlat","allMonstersCostCoef","allPerksCostFlat","allPerksCostCoef","peopleAlertedTimeCoef","theftCoef"],GameModifier.prototype.detectValueNegationForInfo=function(title){return _.contains(GameModifier.NegatedEffectsForInfo,title)},GameModifier.prototype.getValueAndColorForInfo=function(value,renderType,negate){var improvement,sign,text;switch(sign="",text="",renderType){case"flat":improvement=value>0,improvement&&(sign="+"),text=_.roundAndDropZeroes(value,3);break;case"coef":improvement=value>1,improvement&&(sign="+"),text=_.roundAndDropZeroes(100*(value-1),3)+"%";break;case"bool":improvement=value,text="";break;default:throw new Error("unknown render type '"+renderType+"'")}return negate&&(improvement=!improvement),[sign+text,improvement]},GameModifier.prototype.debugDump=function(){var j,len,method,ref,results;for(console.log("Debug dump of game modifier ",this),ref=GameModifier.AllMethods,results=[],j=0,len=ref.length;len>j;j++)method=ref[j],results.push(console.log(method+" = "+this[method]()));return results},GameModifier.prototype.getImage=function(){return"images/modifier_"+this.name+".png"},GameModifier.prototype.generateTranslatedInfo=function(monstersService){var add,addBasicValue,addMonsterValue,defaultGameModifier,r;return defaultGameModifier=new GameModifier,r=[],add=function(_this){return function(keyTitle,value,params){var obj,ref;return obj={originalValue:value},obj.title=GameModifier.translateFunction("common.perkEffect_"+keyTitle,params),obj.renderType=_this.detectRenderType(keyTitle),obj.negate=_this.detectValueNegationForInfo(keyTitle),ref=_this.getValueAndColorForInfo(value,obj.renderType,obj.negate),obj.value=ref[0],obj.isImprovement=ref[1],r.push(obj)}}(this),addBasicValue=function(_this){return function(keyTitle,functionName){var value;return value=_this[functionName](),defaultGameModifier[functionName]()!==value?add(keyTitle,value):void 0}}(this),addMonsterValue=function(_this){return function(keyTitle,functionName){var defaultValue,defaultValues,i,j,monsterText,ref,ref1,results,value,values;for(values=_this[functionName](),defaultValues=defaultGameModifier[functionName](),results=[],i=j=0,ref=values.length;ref>=0?ref>=j:j>=ref;i=ref>=0?++j:--j)ref1=[values[i],defaultValues[i]],value=ref1[0],defaultValue=ref1[1],value!==defaultValue?(monsterText=monstersService.list[i].getTranslatedName(),results.push(add(keyTitle,value,{monster:monsterText}))):results.push(void 0);return results}}(this),addBasicValue("clickCoef","getClickBonusCoef"),addBasicValue("clickFlat","getClickBonusFlat"),addBasicValue("allMonstersCostCoef","getAllMonstersCostCoef"),addBasicValue("allMonstersCostFlat","getAllMonstersCostFlat"),addBasicValue("bonusSpawnTimeCoef","getBonusSpawnTimeCoef"),addBasicValue("allPerksCostFlat","getAllPerksCostFlat"),addBasicValue("allPerksCostCoef","getAllPerksCostCoef"),addBasicValue("enablesHellCards","getEnablesHellCards"),addBasicValue("soulLeakTimeCoef","getSoulLeakTimeCoef"),addBasicValue("peopleAlertedTimeCoef","getPeopleAlertedTimeCoef"),addBasicValue("theftCoef","getTheftCoef"),addBasicValue("allMonsterBonusCoef","getAllMonsterBonusCoef"),addMonsterValue("monsterBonusFlat","getMonsterBonusFlat"),addMonsterValue("monsterBonusCoef","getMonsterBonusCoef"),addMonsterValue("monsterCostFlat","getMonsterCostFlat"),addMonsterValue("monsterCostCoef","getMonsterCostCoef"),{title:GameModifier.translateFunction(this.getTranslatePrefix()+this.name),effects:r}},GameModifier.prototype.refreshCachedInfo=function(monstersService){return this.cachedInfo=this.generateTranslatedInfo(monstersService)},GameModifier.generateCombinedObject=function(inputObjects){var combineValues,fn,j,len,obj,p;for(p=new GameModifier("combined",0),combineValues=function(val,a,b){var res;return res=function(){if(_.endsWith(val,"Flat"))return a+b;if(_.endsWith(val,"Coef"))return a+b-1;if(_.contains(val,"Enables"))return a||b;throw new Error("Unknown value for combination")}()},fn=function(obj){var k,l,len1,len2,old,ref,ref1,results,s,val;for(ref=GameModifier.AllNonMonsterMethods,k=0,len1=ref.length;len1>k;k++)val=ref[k],s=combineValues(val,p[val](),obj[val]()),p[val]=function(s){return function(){return s}}(s);for(ref1=GameModifier.MonsterValueMethods,results=[],l=0,len2=ref1.length;len2>l;l++)val=ref1[l],old=p[val],results.push(p[val]=function(val,old){return function(){return _(old()).zip(obj[val]()).map(function(x){return combineValues(val,x[0],x[1])}).value()}}(val,old));return results},j=0,len=inputObjects.length;len>j;j++)obj=inputObjects[j],fn(obj);return p},GameModifier.prototype.onAddedToGameState=function(state){},GameModifier}(),TimedGameModifier=function(superClass){function TimedGameModifier(durationInSeconds){TimedGameModifier.__super__.constructor.call(this,null),this.duration=1e3*durationInSeconds,this.timeout=null,this.timeRemaining=this.duration,this.timeRemainingPerc=100,this.done=function(modifier){}}return extend(TimedGameModifier,superClass),TimedGameModifier.tickLength=1e3,TimedGameModifier.$timeout=null,TimedGameModifier.prototype.planTick=function(){return this.timeout=TimedGameModifier.$timeout(function(_this){return function(){return _this.tick()}}(this),TimedGameModifier.tickLength)},TimedGameModifier.prototype.start=function(){return this.stop(),this.planTick()},TimedGameModifier.prototype.stop=function(){return null==this.timeout?TimedGameModifier.$timeout.cancel(this.timeout):void 0},TimedGameModifier.prototype.onAddedToGameState=function(state){return this.start()},TimedGameModifier.prototype.tick=function(){return this.timeRemaining-=TimedGameModifier.tickLength,this.timeRemainingPerc=100*this.timeRemaining/this.duration,this.timeRemaining>0?this.planTick():this.done(this)},TimedGameModifier}(GameModifier),AlertedCitizensModifier=function(superClass){function AlertedCitizensModifier(durationCoef){AlertedCitizensModifier.__super__.constructor.call(this,60*durationCoef)}return extend(AlertedCitizensModifier,superClass),AlertedCitizensModifier.prototype.getMonsterBonusCoef=function(){return _.updated(AlertedCitizensModifier.__super__.getMonsterBonusCoef.apply(this,arguments),[[Monster.GhoulId,.12],[Monster.VampireId,.34],[Monster.ReaperId,.67]])},AlertedCitizensModifier}(TimedGameModifier);var GameState;GameState=function(){function GameState(monsterService,perksService,utils){this.monsterService=monsterService,this.perksService=perksService,this.utils=utils,this.monsters=this.monsterService.list,this.perks=this.perksService.list,this.onMonsterHarvest=function(_this){return function(n,id){}}(this),this.reset(),this.refreshAll(),this.utils.afterTranslateReady(function(_this){return function(){return _this.refreshAll()}}(this)),this.monsterIntervals=[]}return GameState.prototype.addSouls=function(n){return n>0?(this.bank+=n,this.normalizeBank(),this.bankChanged()):void 0},GameState.prototype.addSoulsHarvestedByMonster=function(n,id){return this.addSouls(n),this.onMonsterHarvest(n,id)},GameState.prototype.removeSouls=function(n){return n>0&&(this.bank-=n,this.normalizeBank(),this.bankChanged(),this.bank<0)?(console.log("warning, bank underflow!"),this.bank=0):void 0},GameState.prototype.normalizeBank=function(){return this.bank=Math.floor(this.bank)},GameState.prototype.bankChanged=function(){return this.monsterService.refreshCanHire(this),this.perksService.refreshCanAfford(this)},GameState.prototype.addClickSouls=function(){return this.addSouls(this.soulsPerClick),this.soulsPerClick},GameState.prototype.increaseMonsterOwned=function(id){return this.monstersOwned[id]++,this.refreshSoulsPerSecond()},GameState.prototype.decreaseMonsterOwned=function(id){return this.monstersOwned[id]--,this.refreshSoulsPerSecond()},GameState.prototype.canAfford=function(price){return this.bank>=price},GameState.prototype.buyMonster=function(id){var monster,price;return monster=this.monsters[id],this.refreshAll(),price=monster.price,this.canAfford(price)?(this.removeSouls(price),this.increaseMonsterOwned(id),this.refreshAll()):void 0},GameState.prototype.sellMonster=function(id){var monster,price;return monster=this.monsters[id],price=monster.priceSell,monster.computeOwnedCount(this)>0&&price>0?(this.addSouls(price),this.decreaseMonsterOwned(id),this.refreshAll()):void 0},GameState.prototype.buyPerk=function(id){var monPerks,perk,price,tier;return perk=this.perksService.idToPerk[id],monPerks=this.perksService.list[perk.monsterId],tier=monPerks.perkTiers[perk.tierNumber],price=perk.price,tier.canBuy(this)&&this.canAfford(price)&&!_.contains(this.perksOwned,id)?(this.removeSouls(price),this.perksOwned.push(perk.id),this.refreshAll()):void 0},GameState.prototype.sellPerk=function(id){var perk;return _.contains(this.perksOwned,id)?(perk=this.perksService.idToPerk[id],this.perksOwned=_.without(this.perksOwned,id),this.addSouls(perk.price/2),this.refreshAll()):void 0},GameState.prototype.stopAllMonsterIntervals=function($interval){return _.forEach(this.monsterIntervals,function(x){return $interval.cancel(x)})},GameState.prototype.initializeMonsterIntervals=function($interval,coef){var i,len,monster,ref,results;for(null==coef&&(coef=1),this.stopAllMonsterIntervals($interval),this.monsterIntervals=[],ref=this.monsters,results=[],i=0,len=ref.length;len>i;i++)monster=ref[i],results.push(function(_this){return function(monster){var f;return f=function(){return monster.tick(_this)},_this.monsterIntervals.push($interval(f,1e3*monster.harvestDelay*coef))}}(this)(monster));return results},GameState.prototype.refreshSoulsPerSecond=function(){return this.soulsPerSecond=_(this.monsters).map(function(_this){return function(monster){return monster.soulsPerSecond}}(this)).sum()},GameState.prototype.refreshSoulsPerClick=function(){var m;return m=this.combinedModifier,this.soulsPerClick=(1+m.getClickBonusFlat())*m.getClickBonusCoef()},GameState.prototype.reset=function(){return this.bank=0,this.soulsPerSecond=0,this.soulsPerClick=0,this.monstersOwned=_.map(this.monsters,function(){return 0}),this.perksOwned=[],this.modifiers=[],this.perkOwnedById=[],this.refreshAll(),this.refreshAll()},GameState.baseBonusTime=6e4,GameState.prototype.getBonusSpawnDelay=function(){var coef;return coef="undefined"!=typeof combinedModifier&&null!==combinedModifier?combinedModifier.getBonusSpawnTimeCoef():1,5*GameState.baseBonusTime*coef},GameState.prototype.getBonusDespawnDelay=function(){return GameState.baseBonusTime},GameState.prototype.getMonsterPerks=function(monsterId){return _.find(this.perks,function(p){return p.monsterId===monsterId})},GameState.prototype.addModifier=function(modifier){return this.modifiers=_.filter(this.modifiers,function(m){return m.name!==modifier.name}),this.modifiers.push(modifier),this.utils.afterTranslateReady(function(_this){return function(){return modifier.refreshCachedInfo(_this.monsterService)}}(this)),modifier.onAddedToGameState(this),modifier.done=function(_this){return function(m){return _this.onModifierExpiration(m)}}(this),this.refreshAll()},GameState.prototype.onModifierExpiration=function(modifier){return this.modifiers=_.without(this.modifiers,modifier),this.refreshAll()},GameState.prototype.refreshCombinedModifier=function(){var buffs,gen,minBonusSpawnTimeCoef,monsters,perks;return gen=GameModifier.generateCombinedObject,perks=this.perksService.computeCombined(this),monsters=this.monsterService.computeCombined(this),buffs=gen(this.modifiers),this.combinedModifier=gen([perks,buffs,monsters]),minBonusSpawnTimeCoef=.2,this.combinedModifier.getBonusSpawnTimeCoef()<minBonusSpawnTimeCoef&&(this.combinedModifier.getBonusSpawnTimeCoef=function(){return minBonusSpawnTimeCoef}),this.combinedModifier.refreshCachedInfo(this.monsterService)},GameState.prototype.refreshPerkOwnedById=function(){for(;this.perkOwnedById.length>0;)this.perkOwnedById.pop();return this.perksService.forEach(function(_this){return function(p){return _this.perkOwnedById[p.id]=_.contains(_this.perksOwned,p.id)}}(this))},GameState.prototype.refreshAll=function(){return this.monsterService.refreshOwnedCount(this),this.refreshCombinedModifier(),this.monsterService.refreshAll(this),this.perksService.refreshAll(this),this.refreshSoulsPerSecond(),this.refreshSoulsPerClick(),this.refreshPerkOwnedById()},GameState.prototype.serializeToObject=function(){return{bank:this.bank,monstersOwned:this.monstersOwned,perksOwned:this.perksOwned}},GameState.prototype.deserializeFromObject=function(obj){return this.bank=obj.bank,this.monstersOwned=obj.monstersOwned,this.perksOwned=obj.perksOwned,this.refreshAll()},GameState}(),angular.module("soulclicker").service("gameStatePersistence",["localStorageService",function(localStorageService){var keyName;keyName="save",this.save=function(_this){return function(state){return localStorageService.set(keyName,_this["export"](state))}}(this),this.load=function(_this){return function(state){var obj;return state.reset(),obj=localStorageService.get(keyName),
null!=obj?_this["import"](state,obj):void 0}}(this),this["export"]=function(_this){return function(state){return btoa(JSON.stringify(state.serializeToObject()))}}(this),this["import"]=function(_this){return function(state,data){return state.deserializeFromObject(JSON.parse(atob(data)))}}(this)}]);var Monster;Monster=function(){function Monster(name,harvestDelay,harvestAmount,basePrice,selectedGraphicsShiftX,selectedGraphicsShiftY,bulkBonus){this.name=name,this.harvestDelay=harvestDelay,this.harvestAmount=harvestAmount,this.basePrice=basePrice,this.selectedGraphicsShiftX=selectedGraphicsShiftX,this.selectedGraphicsShiftY=selectedGraphicsShiftY,this.bulkBonus=bulkBonus,this.id=Monster.nextId++,this.image="images/monster_"+this.name+".png",this.background="images/monster_"+this.name+"_bg.png",this.oneBonusModifier=this.generateOneBonusModifier(),this.bulkBonusModifier=new GameModifier,this.translatedName="NO TRANSLATION"}return Monster.priceExponent=1.2,Monster.nextId=0,Monster.translateFunction=function(x){return"Missing translate function"},Monster.promiseTranslateFunction=function(x){return"Missing translate function"},Monster.TranslationPrefix="common.monster_",Monster.GhoulId=0,Monster.VampireId=1,Monster.ReaperId=2,Monster.Count=3,Monster.LastId=Monster.Count-1,Monster.prototype.refreshCachedInfo=function(state){return state.utils.afterTranslateReady(function(_this){return function(){return _this.bulkBonusModifier.refreshCachedInfo(state.monsterService),_this.oneBonusModifier.refreshCachedInfo(state.monsterService),_this.translatedName=_this.getTranslatedName()}}(this))},Monster.prototype.refreshAll=function(state){return this.refreshOwnedCount(state),this.bulkBonusModifier=this.generateBulkBonusModifier(state),this.refreshCachedInfo(state),this.productionOfOne=this.computeProductionOfOne(state),this.totalProduction=this.computeTotalProduction(state),this.price=this.computeCurrentPriceFromState(state),this.priceTen=this.computeBatchPriceFromState(state,10),this.priceSell=this.ownedCount>0?this.computePriceFromState(state,this.ownedCount-1)/2:0,this.owned=this.ownedCount>0,this.refreshCanHire(state),this.soulsPerSecondOfOne=this.computeSoulsPerSecondOfOne(state),this.soulsPerSecond=this.computeSoulsPerSecond(state),this.refreshPerkIdsPerTier(state)},Monster.prototype.refreshOwnedCount=function(state){return this.ownedCount=this.computeOwnedCount(state)},Monster.prototype.refreshPerkIdsPerTier=function(state){var monsterPerks;return monsterPerks=state.perksService.list[this.id],this.perkIdsPerTier=monsterPerks.generatePerkIdsPerTier(state)},Monster.prototype.refreshCanHire=function(state){this.canHire=this.computeCanHire(state),this.canHireTen=this.computeCanHireTen(state)},Monster.prototype.computeOwnedCount=function(state){return state.monstersOwned[this.id]},Monster.prototype.computeProductionOfOne=function(state){var m;return m=state.combinedModifier,(this.harvestAmount+m.getMonsterBonusFlat()[this.id])*m.getMonsterBonusCoef()[this.id]*m.getAllMonsterBonusCoef()},Monster.prototype.computeTotalProduction=function(state){return this.computeProductionOfOne(state)*this.computeOwnedCount(state)},Monster.prototype.computePrice=function(n){return Math.round(this.basePrice*Math.pow(Monster.priceExponent,n))},Monster.prototype.computePriceFromState=function(state,n){var m;return m=state.combinedModifier,null!=m?(this.computePrice(n)+m.getAllMonstersCostFlat()+m.getMonsterBonusFlat()[this.id])*m.getAllMonstersCostCoef()*m.getMonsterCostCoef()[this.id]:this.computePrice(n)},Monster.prototype.computeCurrentPriceFromState=function(state){return this.computePriceFromState(state,this.computeOwnedCount(state))},Monster.prototype.computeBatchPriceFromState=function(state,amount){var owned,results;return owned=this.computeOwnedCount(state),_(function(){results=[];for(var i=owned,ref=owned+amount;ref>=owned?ref>=i:i>=ref;ref>=owned?i++:i--)results.push(i);return results}.apply(this)).map(function(_this){return function(n){return _this.computePriceFromState(state,n)}}(this)).sum()},Monster.prototype.computeCanHire=function(state){return state.bank>=this.price},Monster.prototype.computeCanHireTen=function(state){return state.bank>=this.priceTen},Monster.prototype.computeSoulsPerSecondOfOne=function(state){return this.computeProductionOfOne(state)/this.harvestDelay},Monster.prototype.computeSoulsPerSecond=function(state){return this.computeTotalProduction(state)/this.harvestDelay},Monster.prototype.getTranslatedName=function(){return Monster.translateFunction(Monster.TranslationPrefix+this.name)},Monster.prototype.getTranslatedNamePromise=function(){return Monster.promiseTranslateFunction(Monster.TranslationPrefix+this.name)},Monster.prototype.tick=function(state){return this.owned?state.addSoulsHarvestedByMonster(this.totalProduction,this.id):void 0},Monster.prototype.generateOneBonusModifier=function(){var fn,key,modif,ref,value;modif=new GameModifier,ref=this.bulkBonus,fn=function(_this){return function(value){return modif[key]=function(){return value}}}(this);for(key in ref)value=ref[key],fn(value);return modif},Monster.prototype.generateBulkBonusModifier=function(state){return GameModifier.generateCombinedObject(_.times(this.computeOwnedCount(state),function(_this){return function(){return _this.oneBonusModifier}}(this)))},Monster}(),angular.module("soulclicker").service("monsters",["utils",function(utils){this.list=[],this.list[Monster.GhoulId]=new Monster("ghoul",7,3,15,0,1/6,{getClickBonusFlat:2,getClickBonusCoef:1.02}),this.list[Monster.VampireId]=new Monster("vampire",3,21,500,0,0,{getClickBonusCoef:1.01,getBonusSpawnTimeCoef:.98}),this.list[Monster.ReaperId]=new Monster("reaper",5,630,5e3,1/12,0,{getAllMonsterBonusCoef:1.02}),Monster.translateFunction=utils.translate,Monster.promiseTranslateFunction=utils.translatePromise,this.refreshAll=function(state){return _.forEach(this.list,function(m){return m.refreshAll(state)})},this.refreshCanHire=function(state){return _.forEach(this.list,function(m){return m.refreshCanHire(state)})},this.refreshOwnedCount=function(state){return _.forEach(this.list,function(m){return m.refreshOwnedCount(state)})},this.computeCombined=function(state){var tmp;return tmp=[],_.forEach(this.list,function(m){return tmp.push(m.bulkBonusModifier)}),GameModifier.generateCombinedObject(tmp)},utils.afterTranslateReady(function(_this){return function(){return _.forEach(_this.list,function(m){return m.oneBonusModifier.refreshCachedInfo(_this)})}}(this))}]);var BackupScythePerk,BloodExperimentsPerk,BloodhoundPerk,BorrowedWeaponPerk,BroodingPerk,BrothersOfDeathPerk,CapaciousJarPerk,CatchTrainingPerk,CircumspectionPerk,CooperationTrainingPerk,ElectricGhoulPerk,FightTrainingPerk,GhoulPerk,HellPortalPerk,HighAristocracyPerk,ImprovedClothPerk,ImprovedNobilityPerk,ImprovedPerceptionPerk,MindTrainingPerk,ObsidianJarPerk,OverlordPerk,Perk,ReaperPerk,SneakTrainingPerk,SoulTrackingPerk,SpareJarsPerk,SummoningTrialsPerk,TeethSharpenerPerk,TrainingOfCalmingPerk,VampirePerk,WinDraculasFavorPerk,extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;Perk=function(superClass){function Perk(name,priceCoef){if(null==name&&(name=null),this.priceCoef=null!=priceCoef?priceCoef:1,Perk.__super__.constructor.call(this,name),this.id=Perk.nextId++,this.tierNumber=null,this.monsterId=null,"Perk"===Perk.constructor.name&&"Perk"!==_.takeRight(this.constructor.name,4).join(""))throw new Error("Perk class name is not ending with word 'Perk'");this.name=_.dropRight(this.name,4).join(""),this.price=this.computePriceWithoutState(),this.nextId=0,this.canAfford=!1}return extend(Perk,superClass),Perk.init=function(){return Perk.nextId=0},Perk.prototype.getImage=function(){return"images/perk_"+this.name+".png"},Perk.prototype.getTranslatePrefix=function(){return"common.perk_"},Perk.prototype.computePriceWithoutState=function(){return this.priceCoef*Perk.basePrice*Perk.basicPriceCoefsByTier[this.tierNumber]*this.priceCoefsByTier()[this.tierNumber]},Perk.prototype.computePrice=function(state){var m;return m=state.combinedModifier,(this.computePriceWithoutState(state)+m.getAllPerksCostFlat())*m.getAllPerksCostCoef()},Perk.basePrice=500,Perk.basicPriceCoefsByTier=[1].concat(_.map([1,2],function(x){return Math.pow(10,2*x)})),Perk.prototype.priceCoefsByTier=function(){return[1,1,1]},Perk.prototype.refreshAll=function(state){return this.price=this.computePrice(state),this.refreshCanAfford(state)},Perk.prototype.refreshCanAfford=function(state){return this.canAfford=state.bank>=this.price},Perk}(GameModifier),GhoulPerk=function(superClass){function GhoulPerk(){return GhoulPerk.__super__.constructor.apply(this,arguments)}return extend(GhoulPerk,superClass),GhoulPerk}(Perk),CapaciousJarPerk=function(superClass){function CapaciousJarPerk(){CapaciousJarPerk.__super__.constructor.call(this,null,.75)}return extend(CapaciousJarPerk,superClass),CapaciousJarPerk.prototype.getClickBonusFlat=function(){return 10},CapaciousJarPerk.prototype.getAllMonstersCostCoef=function(){return.95},CapaciousJarPerk.prototype.getMonsterBonusCoef=function(){return _.updated(CapaciousJarPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.GhoulId,1.8)},CapaciousJarPerk}(GhoulPerk),FightTrainingPerk=function(superClass){function FightTrainingPerk(){return FightTrainingPerk.__super__.constructor.apply(this,arguments)}return extend(FightTrainingPerk,superClass),FightTrainingPerk.prototype.getMonsterBonusCoef=function(){return _.updated(FightTrainingPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.GhoulId,2.2)},FightTrainingPerk.prototype.getAllPerksCostCoef=function(){return.95},FightTrainingPerk}(GhoulPerk),ImprovedPerceptionPerk=function(superClass){function ImprovedPerceptionPerk(){return ImprovedPerceptionPerk.__super__.constructor.apply(this,arguments)}return extend(ImprovedPerceptionPerk,superClass),ImprovedPerceptionPerk.prototype.getBonusSpawnTimeCoef=function(){return.75},ImprovedPerceptionPerk.prototype.getAllPerksCostCoef=function(){return.85},ImprovedPerceptionPerk.prototype.getMonsterBonusCoef=function(){return _.updated(ImprovedPerceptionPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.GhoulId,2.2)},ImprovedPerceptionPerk}(GhoulPerk),SpareJarsPerk=function(superClass){function SpareJarsPerk(){return SpareJarsPerk.__super__.constructor.apply(this,arguments)}return extend(SpareJarsPerk,superClass),SpareJarsPerk.prototype.getClickBonusFlat=function(){return 75},SpareJarsPerk.prototype.getAllPerksCostCoef=function(){return.9},SpareJarsPerk.prototype.getMonsterBonusCoef=function(){return _.updated(SpareJarsPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.GhoulId,2)},SpareJarsPerk}(GhoulPerk),MindTrainingPerk=function(superClass){function MindTrainingPerk(){return MindTrainingPerk.__super__.constructor.apply(this,arguments)}return extend(MindTrainingPerk,superClass),MindTrainingPerk.prototype.getMonsterBonusCoef=function(){return _.updated(MindTrainingPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.GhoulId,2.5)},MindTrainingPerk.prototype.getAllMonsterBonusCoef=function(){return 1.1},MindTrainingPerk}(GhoulPerk),CatchTrainingPerk=function(superClass){function CatchTrainingPerk(){return CatchTrainingPerk.__super__.constructor.apply(this,arguments)}return extend(CatchTrainingPerk,superClass),CatchTrainingPerk.prototype.getMonsterBonusCoef=function(){return _.updated(CatchTrainingPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.GhoulId,1.85)},CatchTrainingPerk.prototype.getSoulLeakTimeCoef=function(){return 2.5},CatchTrainingPerk}(GhoulPerk),ObsidianJarPerk=function(superClass){function ObsidianJarPerk(){return ObsidianJarPerk.__super__.constructor.apply(this,arguments)}return extend(ObsidianJarPerk,superClass),ObsidianJarPerk.prototype.getClickBonusFlat=function(){return 150},ObsidianJarPerk.prototype.getClickBonusCoef=function(){return 1.25},ObsidianJarPerk.prototype.getMonsterBonusCoef=function(){return _.updated(ObsidianJarPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.GhoulId,1.95)},ObsidianJarPerk}(GhoulPerk),CooperationTrainingPerk=function(superClass){function CooperationTrainingPerk(){return CooperationTrainingPerk.__super__.constructor.apply(this,arguments)}return extend(CooperationTrainingPerk,superClass),CooperationTrainingPerk.prototype.getMonsterBonusCoef=function(){return _.updated(CooperationTrainingPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.GhoulId,2.5)},CooperationTrainingPerk.prototype.getAllMonsterBonusCoef=function(){return 1.5},CooperationTrainingPerk}(GhoulPerk),ElectricGhoulPerk=function(superClass){function ElectricGhoulPerk(){return ElectricGhoulPerk.__super__.constructor.apply(this,arguments)}return extend(ElectricGhoulPerk,superClass),ElectricGhoulPerk.prototype.getAllMonsterBonusCoef=function(){return 1.3},ElectricGhoulPerk.prototype.getEnablesHellCards=function(){return!0},ElectricGhoulPerk.prototype.getAllPerksCostCoef=function(){return.75},ElectricGhoulPerk.prototype.getMonsterBonusCoef=function(){return _.updated(ElectricGhoulPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.GhoulId,1.7)},ElectricGhoulPerk}(GhoulPerk),VampirePerk=function(superClass){function VampirePerk(){return VampirePerk.__super__.constructor.apply(this,arguments)}return extend(VampirePerk,superClass),VampirePerk.prototype.priceCoefsByTier=function(){return[30,40,50]},VampirePerk}(Perk),ImprovedNobilityPerk=function(superClass){function ImprovedNobilityPerk(){return ImprovedNobilityPerk.__super__.constructor.apply(this,arguments)}return extend(ImprovedNobilityPerk,superClass),ImprovedNobilityPerk.prototype.getClickBonusCoef=function(){return 1.15},ImprovedNobilityPerk.prototype.getMonsterBonusCoef=function(){return _.updated(ImprovedNobilityPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.VampireId,1.9)},ImprovedNobilityPerk}(VampirePerk),TeethSharpenerPerk=function(superClass){function TeethSharpenerPerk(){return TeethSharpenerPerk.__super__.constructor.apply(this,arguments)}return extend(TeethSharpenerPerk,superClass),TeethSharpenerPerk.prototype.getMonsterBonusCoef=function(){return _.updated(TeethSharpenerPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.VampireId,2.3)},TeethSharpenerPerk}(VampirePerk),BloodExperimentsPerk=function(superClass){function BloodExperimentsPerk(){return BloodExperimentsPerk.__super__.constructor.apply(this,arguments)}return extend(BloodExperimentsPerk,superClass),BloodExperimentsPerk.prototype.getMonsterBonusCoef=function(){return _.updated(BloodExperimentsPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.VampireId,1.9)},BloodExperimentsPerk.prototype.getAllMonstersCostCoef=function(){return.95},BloodExperimentsPerk.prototype.getEnablesHellCards=function(){return!0},BloodExperimentsPerk}(VampirePerk),HighAristocracyPerk=function(superClass){function HighAristocracyPerk(){return HighAristocracyPerk.__super__.constructor.apply(this,arguments)}return extend(HighAristocracyPerk,superClass),HighAristocracyPerk.prototype.getClickBonusCoef=function(){return 1.35},HighAristocracyPerk.prototype.getMonsterBonusCoef=function(){return _.updated(HighAristocracyPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.VampireId,1.9)},HighAristocracyPerk}(VampirePerk),SneakTrainingPerk=function(superClass){function SneakTrainingPerk(){return SneakTrainingPerk.__super__.constructor.apply(this,arguments)}return extend(SneakTrainingPerk,superClass),SneakTrainingPerk.prototype.getMonsterBonusCoef=function(){return _.updated(SneakTrainingPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.VampireId,2.5)},SneakTrainingPerk}(VampirePerk),TrainingOfCalmingPerk=function(superClass){function TrainingOfCalmingPerk(){return TrainingOfCalmingPerk.__super__.constructor.apply(this,arguments)}return extend(TrainingOfCalmingPerk,superClass),TrainingOfCalmingPerk.prototype.getPeopleAlertedTimeCoef=function(){return.05},TrainingOfCalmingPerk.prototype.getMonsterBonusCoef=function(){return _.updated(TrainingOfCalmingPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.VampireId,1.8)},TrainingOfCalmingPerk}(VampirePerk),OverlordPerk=function(superClass){function OverlordPerk(){return OverlordPerk.__super__.constructor.apply(this,arguments)}return extend(OverlordPerk,superClass),OverlordPerk.prototype.getClickBonusCoef=function(){return 1.75},OverlordPerk.prototype.getClickBonusFlat=function(){return 5},OverlordPerk.prototype.getMonsterBonusCoef=function(){return _.updated(OverlordPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.VampireId,2)},OverlordPerk}(VampirePerk),WinDraculasFavorPerk=function(superClass){function WinDraculasFavorPerk(){return WinDraculasFavorPerk.__super__.constructor.apply(this,arguments)}return extend(WinDraculasFavorPerk,superClass),WinDraculasFavorPerk.prototype.getMonsterBonusCoef=function(){return _.updated(WinDraculasFavorPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.VampireId,3.2)},WinDraculasFavorPerk.prototype.getAllMonsterBonusCoef=function(){return 1.5},WinDraculasFavorPerk}(VampirePerk),CircumspectionPerk=function(superClass){function CircumspectionPerk(){return CircumspectionPerk.__super__.constructor.apply(this,arguments)}return extend(CircumspectionPerk,superClass),CircumspectionPerk.prototype.getMonsterBonusCoef=function(){return _.updated(CircumspectionPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.VampireId,2)},CircumspectionPerk.prototype.getBonusSpawnTimeCoef=function(){return.5},CircumspectionPerk}(VampirePerk),ReaperPerk=function(superClass){function ReaperPerk(){return ReaperPerk.__super__.constructor.apply(this,arguments)}return extend(ReaperPerk,superClass),ReaperPerk.prototype.priceCoefsByTier=function(){return[40,150,240]},ReaperPerk}(Perk),BroodingPerk=function(superClass){function BroodingPerk(){return BroodingPerk.__super__.constructor.apply(this,arguments)}return extend(BroodingPerk,superClass),BroodingPerk.prototype.getClickBonusFlat=function(){return 25},BroodingPerk.prototype.getClickBonusCoef=function(){return 1.25},BroodingPerk.prototype.getMonsterBonusCoef=function(){return _.updated(BroodingPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.ReaperId,1.7)},BroodingPerk}(ReaperPerk),BackupScythePerk=function(superClass){function BackupScythePerk(){return BackupScythePerk.__super__.constructor.apply(this,arguments)}return extend(BackupScythePerk,superClass),BackupScythePerk.prototype.getMonsterBonusCoef=function(){return _.updated(BackupScythePerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.ReaperId,2.1)},BackupScythePerk.prototype.getAllMonstersCostFlat=function(){return-5},BackupScythePerk}(ReaperPerk),HellPortalPerk=function(superClass){function HellPortalPerk(){return HellPortalPerk.__super__.constructor.apply(this,arguments)}return extend(HellPortalPerk,superClass),HellPortalPerk.prototype.getAllMonstersCostCoef=function(){return.95},HellPortalPerk.prototype.getEnablesHellCards=function(){return!0},HellPortalPerk.prototype.getMonsterBonusCoef=function(){return _.updated(HellPortalPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.ReaperId,1.8)},HellPortalPerk}(ReaperPerk),ImprovedClothPerk=function(superClass){function ImprovedClothPerk(){return ImprovedClothPerk.__super__.constructor.apply(this,arguments)}return extend(ImprovedClothPerk,superClass),ImprovedClothPerk.prototype.getClickBonusFlat=function(){return 7},ImprovedClothPerk.prototype.getClickBonusCoef=function(){return 1.15},ImprovedClothPerk.prototype.getMonsterBonusCoef=function(){return _.updated(ImprovedClothPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.ReaperId,1.8)},ImprovedClothPerk}(ReaperPerk),SoulTrackingPerk=function(superClass){function SoulTrackingPerk(){return SoulTrackingPerk.__super__.constructor.apply(this,arguments)}return extend(SoulTrackingPerk,superClass),SoulTrackingPerk.prototype.getMonsterBonusCoef=function(){return _.updated(SoulTrackingPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.ReaperId,2)},SoulTrackingPerk.prototype.getAllMonsterBonusCoef=function(){return 1.1},SoulTrackingPerk.prototype.getSoulLeakTimeCoef=function(){return 1.05},SoulTrackingPerk}(ReaperPerk),SummoningTrialsPerk=function(superClass){function SummoningTrialsPerk(){return SummoningTrialsPerk.__super__.constructor.apply(this,arguments)}return extend(SummoningTrialsPerk,superClass),SummoningTrialsPerk.prototype.getMonsterBonusCoef=function(){return _.updated(SummoningTrialsPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.ReaperId,1.8)},SummoningTrialsPerk.prototype.getBonusSpawnTimeCoef=function(){return.5},SummoningTrialsPerk.prototype.getEnablesHellCards=function(){return!0},SummoningTrialsPerk.prototype.getAllMonstersCostCoef=function(){return.97},SummoningTrialsPerk}(ReaperPerk),BorrowedWeaponPerk=function(superClass){function BorrowedWeaponPerk(){return BorrowedWeaponPerk.__super__.constructor.apply(this,arguments)}return extend(BorrowedWeaponPerk,superClass),BorrowedWeaponPerk.prototype.getClickBonusFlat=function(){return 25},BorrowedWeaponPerk.prototype.getClickBonusCoef=function(){return 1.25},BorrowedWeaponPerk.prototype.getAllMonsterBonusCoef=function(){return.98},BorrowedWeaponPerk.prototype.getMonsterBonusCoef=function(){return _.updated(BorrowedWeaponPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.ReaperId,2.2)},BorrowedWeaponPerk}(ReaperPerk),BrothersOfDeathPerk=function(superClass){function BrothersOfDeathPerk(){return BrothersOfDeathPerk.__super__.constructor.apply(this,arguments)}return extend(BrothersOfDeathPerk,superClass),BrothersOfDeathPerk.prototype.getMonsterBonusCoef=function(){return _.updated(BrothersOfDeathPerk.__super__.getMonsterBonusCoef.apply(this,arguments),[[Monster.ReaperId,1.8],[Monster.VampireId,2.3],[Monster.GhoulId,2.3]])},BrothersOfDeathPerk}(ReaperPerk),BloodhoundPerk=function(superClass){function BloodhoundPerk(){return BloodhoundPerk.__super__.constructor.apply(this,arguments)}return extend(BloodhoundPerk,superClass),BloodhoundPerk.prototype.getMonsterBonusCoef=function(){return _.updated(BloodhoundPerk.__super__.getMonsterBonusCoef.apply(this,arguments),Monster.ReaperId,2.4)},BloodhoundPerk.prototype.getTheftCoef=function(){return-.5},BloodhoundPerk.prototype.getAllPerksCostCoef=function(){return.85},BloodhoundPerk.prototype.getAllMonstersCostCoef=function(){return.95},BloodhoundPerk}(ReaperPerk);var MonsterPerks,PerksTier,indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1};angular.module("soulclicker").service("perks",["utils","monsters",function(utils,monsters){var addToList;Perk.init(),this.list=[],addToList=function(_this){return function(monsterId,tiers){return _this.list[monsterId]=new MonsterPerks(monsterId,tiers)}}(this),addToList(Monster.GhoulId,[new PerksTier(0,[new CapaciousJarPerk,new FightTrainingPerk,new ImprovedPerceptionPerk]),new PerksTier(1,[new SpareJarsPerk,new MindTrainingPerk,new CatchTrainingPerk]),new PerksTier(2,[new ObsidianJarPerk,new CooperationTrainingPerk,new ElectricGhoulPerk])]),addToList(Monster.VampireId,[new PerksTier(0,[new ImprovedNobilityPerk,new TeethSharpenerPerk,new BloodExperimentsPerk]),new PerksTier(1,[new HighAristocracyPerk,new SneakTrainingPerk,new TrainingOfCalmingPerk]),new PerksTier(2,[new OverlordPerk,new WinDraculasFavorPerk,new CircumspectionPerk])]),addToList(Monster.ReaperId,[new PerksTier(0,[new BroodingPerk,new BackupScythePerk,new HellPortalPerk]),new PerksTier(1,[new ImprovedClothPerk,new SoulTrackingPerk,new SummoningTrialsPerk]),new PerksTier(2,[new BorrowedWeaponPerk,new BrothersOfDeathPerk,new BloodhoundPerk])]),this.forEach=function(_this){return function(f){return _.forEach(_this.list,function(mp){_.forEach(mp.perkTiers,function(pt){_.forEach(pt.perks,function(p){f(p)})})})}}(this),this.queueRefreshCachedInfo=function(_this){return function(){return utils.afterTranslateReady(function(){return _this.forEach(function(perk){return perk.refreshCachedInfo(monsters)})})}}(this),this.queueRefreshCachedInfo(),this.refreshAll=function(_this){return function(state){return _this.forEach(function(perk){return perk.refreshAll(state)})}}(this),this.computeCombined=function(_this){return function(state){return GameModifier.generateCombinedObject(_.map(_this.list,function(mp){return mp.computeCombined(state)}))}}(this),this.refreshCanAfford=function(_this){return function(state){return _this.forEach(function(perk){return perk.refreshCanAfford(state)})}}(this),this.idToPerk=[],this.forEach(function(_this){return function(p){return _this.idToPerk[p.id]=p}}(this))}]),PerksTier=function(){function PerksTier(tierNumber,perks){this.tierNumber=tierNumber,this.perks=perks,_.forEach(this.perks,function(_this){return function(p){return p.tierNumber=_this.tierNumber}}(this))}return PerksTier.prototype.computeCombined=function(state){return GameModifier.generateCombinedObject(_.filter(this.perks,function(p){var ref;return ref=p.id,indexOf.call(state.perksOwned,ref)>=0}))},PerksTier.prototype.setMonsterId=function(monsterId1){return this.monsterId=monsterId1,_.forEach(this.perks,function(_this){return function(p){return p.monsterId=_this.monsterId}}(this))},PerksTier.prototype.canBuy=function(state){return 0===this.boughtPerks(state).length},PerksTier.prototype.boughtPerks=function(state){return _(state.perksOwned).map(function(_this){return function(pId){return _.find(_this.perks,function(p){return p.id===pId})}}(this)).filter().value()},PerksTier.prototype.boughtPerk=function(state){return _.head(this.boughtPerks(state))},PerksTier}(),MonsterPerks=function(){function MonsterPerks(monsterId1,perkTiers){this.monsterId=monsterId1,this.perkTiers=perkTiers,_.forEach(this.perkTiers,function(_this){return function(tier){return tier.setMonsterId(_this.monsterId)}}(this))}return MonsterPerks.prototype.computeCombined=function(state){return GameModifier.generateCombinedObject(_.map(this.perkTiers,function(tier){return tier.computeCombined(state)}))},MonsterPerks.prototype.generatePerkIdsPerTier=function(state){return _(this.perkTiers).map(function(pt){var r;return r=pt.boughtPerk(state),null!=r?r:!1}).value()},MonsterPerks}(),angular.module("soulclicker").controller("BottleCtrl",["format","$scope","utils",function(format,$scope,utils){this.formatNumber=format.formatNumber,this.triggered=function(event){$scope.triggered(event.pageX,event.pageY)}}]),angular.module("soulclicker").directive("bottle",function(){return{controller:"BottleCtrl",controllerAs:"ctrl",templateUrl:"app/bottle/bottle.template.html",restrict:"E",scope:{bank:"@",perSecond:"@",perClick:"@",triggered:"=",modifiers:"="}}}),angular.module("soulclicker").controller("InfoCtrl",function(){}),angular.module("soulclicker").directive("info",function(){return{controller:"InfoCtrl",controllerAs:"ctrl",templateUrl:"app/info/info.template.html",restrict:"E",transclude:!0,scope:{title:"@",count:"@"}}}),angular.module("soulclicker").controller("ModifierEffectsCtrl",function(){}),angular.module("soulclicker").directive("modifierEffects",function(){return{controller:"ModifierEffectsCtrl",controllerAs:"ctrl",templateUrl:"app/info/modifier-effects.template.html",restrict:"E",scope:{modifier:"="}}});var showModifierInfoDialog;showModifierInfoDialog=function(customDialog,options){return customDialog.show({targetEvent:options.event,parent:angular.element(document.body),templateUrl:"app/info/modifier-info-dialog.template.html",controllerAs:"ctrl",controller:function($mdDialog,$scope){$scope.modifier=options.modifier,this.close=function(){return $mdDialog.hide()}},locals:{options:options},bindToController:!0})},angular.module("soulclicker").controller("ModifierItemCtrl",["$element","$scope","customDialog",function($element,$scope,customDialog){var m;m=$scope.modifier,$element.find(".modifier-bar").velocity({width:["0%","100%"]},m.timeRemaining),$scope.showInfo=function($event){return showModifierInfoDialog(customDialog,{modifier:$scope.modifier,event:$event})}}]),angular.module("soulclicker").directive("modifierItem",function(){return{controller:"ModifierItemCtrl",controllerAs:"ctrl",templateUrl:"app/info/modifier-item.template.html",restrict:"E",scope:{modifier:"="}}}),angular.module("soulclicker").controller("ModifiersCtrl",function(){}),angular.module("soulclicker").directive("modifiersInfo",function(){return{controller:"ModifiersCtrl",controllerAs:"ctrl",templateUrl:"app/info/modifiers-info.template.html",restrict:"E",scope:{modifiers:"="}}}),angular.module("soulclicker").controller("PerkTierInfoCtrl",["format","$scope",function(format,$scope){var fn,i,len,perkId,ref;for(this.formatNumber=$scope.formatNumber=format.formatNumber,this.buyClicked=function(_this){return function(id){return $scope.buyClicked(id),$scope.forceRefresh()}}(this),this.sellClicked=function(_this){return function(id){return $scope.sellClicked(id),$scope.forceRefresh()}}(this),$scope.boughtPerkId=-1,ref=_.map($scope.tier.perks,function(x){return x.id}),fn=function(perkId){return $scope.$watch("state.perkOwnedById["+perkId+"]",function(_this){return function(newVal,oldVal){return newVal?$scope.boughtPerkId=perkId:void 0}}(this))},i=0,len=ref.length;len>i;i++)perkId=ref[i],fn(perkId)}]),angular.module("soulclicker").directive("perkTierInfo",function(){return{controller:"PerkTierInfoCtrl",controllerAs:"ctrl",templateUrl:"app/info/perk-tier-info.template.html",restrict:"E",scope:{tier:"=",canBuy:"=",state:"=",buyClicked:"=",forceRefresh:"=",sellClicked:"="}}}),angular.module("soulclicker").controller("ArmyCtrl",["utils","$scope",function(utils,$scope){this.utils=utils,$scope.$watch("state.monstersOwned[monster.id]",function(_this){return function(){var amount;return $scope.amount=amount=$scope.monster.ownedCount,$scope.range=_this.utils.range(_.min([amount,25]))}}(this))}]),angular.module("soulclicker").directive("army",function(){return{controller:"ArmyCtrl",controllerAs:"ctrl",templateUrl:"app/monster/army.template.html",restrict:"E",scope:{state:"=",monster:"="}}}),angular.module("soulclicker").controller("MonsterInfoCtrl",["format","$scope",function(format,$scope){var fillData;this.formatNumber=$scope.formatNumber=format.formatNumber,this.hireClicked=function(_this){return function(){return $scope.monster.canHire?$scope.hireClicked():void 0}}(this),this.fireClicked=function(_this){return function(){return $scope.monster.computeOwnedCount($scope.state)>0?$scope.fireClicked():void 0}}(this),this.buyPerkClicked=function(_this){return function(id){return $scope.buyPerkClicked(id)}}(this),this.sellPerkClicked=function(_this){return function(id){return $scope.sellPerkClicked(id)}}(this),this.hireTenClicked=function(_this){return function(id){return $scope.hireTenClicked(id)}}(this),fillData=function(_this){return function(){return $scope.monster.getTranslatedNamePromise().then(function(name){return $scope.incomeOneNumber=_this.formatNumber($scope.monster.soulsPerSecondOfOne,!1),$scope.incomeOneParameters={name:_.decapitalize(name),value:_this.formatNumber($scope.monster.productionOfOne),delay:$scope.monster.harvestDelay,SPSone:$scope.incomeOneNumber},$scope.incomeLongParameters={delay:$scope.monster.harvestDelay,value:_this.formatNumber($scope.monster.totalProduction)}}),$scope.formattedSPS=_this.formatNumber($scope.monster.soulsPerSecond,!1),$scope.canBuyInTier=_.map($scope.monster.perkIdsPerTier,function(x){return!x})}}(this),$scope.$watch("monster",fillData),$scope.$watch("monster.translatedName",fillData),$scope.$watch("state.monstersOwned[monster.id]",fillData),this.forceFillData=function(_this){return function(){return fillData()}}(this)}]),angular.module("soulclicker").directive("monsterInfo",function(){
return{controller:"MonsterInfoCtrl",controllerAs:"ctrl",templateUrl:"app/monster/monster-info.template.html",restrict:"E",scope:{monster:"=",state:"=",hireClicked:"=",fireClicked:"=",buyPerkClicked:"=",sellPerkClicked:"=",hireTenClicked:"="}}}),angular.module("soulclicker").controller("MonsterCtrl",["format","$element","$scope","$timeout",function(format,$element,$scope,$timeout){this.ratio=1260/2015,this.formatNumber=format.formatNumber,this.fixShadow=function(_this){return function(){var bottom,children,cr,h,left,monsterElem,origWidth,shadowElem,w;return children=$($element).children(),monsterElem=$(children[1]),shadowElem=$(children[0]),w=monsterElem.width(),origWidth=w,h=monsterElem.height(),cr=w/h,cr>=_this.ratio&&(w=h*_this.ratio),left=w*$scope.monster.selectedGraphicsShiftX,bottom=w*$scope.monster.selectedGraphicsShiftY,shadowElem.css("margin-left",left+"px").css("margin-bottom",bottom+"px").css("width",w).css("height",w/4).css("left",origWidth/2-w/2)}}(this),this.fixShadow(),$(window).resize(function(_this){return function(){return _this.fixShadow()}}(this)),$timeout(function(_this){return function(){return _this.fixShadow()}}(this),100)}]),angular.module("soulclicker").directive("monster",function(){return{controller:"MonsterCtrl",controllerAs:"ctrl",templateUrl:"app/monster/monster.template.html",restrict:"E",scope:{monster:"=",onSelected:"&",isSelected:"@"}}}),angular.module("soulclicker").controller("OptionsDialogController",["$mdDialog","customDialog","translation","$scope","monsters","format","optionsPersistence",function($mdDialog,customDialog,translation,$scope,monsters,format,optionsPersistence){var debug;debug=!1,this.close=function(){return $mdDialog.hide()},this.reset=function(_this){return function($event){return showResetConfirmDialog(customDialog,{action:function(){return _this.options.onResetClicked()}},_this.options)}}(this),this.tr=translation,this.fm=format,$scope.$watch("ctrl.tr.language",function(_this){return function(newVal,oldVal){return debug&&console.log("changing locale to ",newVal),translation.updateLocale(),optionsPersistence.saveOptions()}}(this)),$scope.$watch("ctrl.fm.scale",function(_this){return function(newVal,oldVal){return debug&&console.log("changing scale to ",newVal),optionsPersistence.saveOptions()}}(this)),$scope["export"]=function(_this){return function(){return $scope.exportText=_this.options["export"]()}}(this),$scope["import"]=function(_this){return function(){try{return _this.options["import"]($scope.importText),$scope.importText=translation.translate("common.imported")}catch(_error){return $scope.importText=translation.translate("common.invalidData")}}}(this)}]);var showOptionsDialog;showOptionsDialog=function(customDialog,$event,options){return options.event=$event,customDialog.show({parent:angular.element(document.body),targetEvent:$event,templateUrl:"app/options/options.template.html",controller:"OptionsDialogController",controllerAs:"ctrl",locals:{options:options},bindToController:!0})};var showResetConfirmDialog;showResetConfirmDialog=function(customDialog,options,optionsOptions){return customDialog.show({parent:angular.element(document.body),templateUrl:"app/options/resetConfirm.template.html",controllerAs:"ctrl",controller:function($mdDialog){this.close=function(){return $mdDialog.hide()},this.action=function(_this){return function(){return _this.options.action(),_this.close()}}(this)},locals:{options:options},bindToController:!0})},angular.module("soulclicker").controller("StatsDialogController",["$mdDialog","customDialog","$scope",function($mdDialog,customDialog,$scope){this.close=function(){return $mdDialog.hide()}}]);var showStatsDialog;showStatsDialog=function(customDialog,$event,options){return options.event=$event,customDialog.show({parent:angular.element(document.body),targetEvent:$event,templateUrl:"app/stats/stats.template.html",controller:"StatsDialogController",controllerAs:"ctrl",locals:{options:options},bindToController:!0})};